{"version":3,"sources":["main.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["sin","Math","cos","atan2","controlKey","up","down","left","right","shoot","focus","canvas","document","getElementById","c","getContext","c_width","window","screen","width","c_height","innerHeight","height","style","background","lineWidth","strokeStyle","fillStyle","font","maxR","minR","minVertices","maxVertices","maxMapHeight","startMapLevel","n_enemy","bullet","keyPressedPool","Set","p_angle","angle","translate_x","translate_y","o_bulletTimer","bulletTimer","org_x","org_y","org_player_x","org_player_y","player_size","player","enemy","score","scoremult","popUps","enemiesToShowHealth","isEndless","isHardMode","Bullet","x","y","r","_dir","bulletSpeed","px","py","img","can","createElement","_c","beginPath","arc","PI","fill","dir","state","damage","speed","bullet_start_dir","ModifiedRandomAboveAvg","random","ModifiedRandomBelowAvg","getMaxMinCo_Enemy","_enemy","x_arr","data","map","a","ox","x_max","max","x_min","min","y_arr","b","oy","y_max","y_min","xMax","xMin","yMax","yMin","normalizeVector","_x","_y","mag","sqrt","checkCollision","x1","y1","x2","y2","x3","y3","x4","y4","dem","uA","uB","checkCollision_Bullet_Enemy","_bullet","xC","yC","minIndex","minDistSq","xM","yM","_nx","_ny","i","l","length","xA","yA","xB","yB","_an","_bn","_xM","_yM","distSq","n","IM","dotP","m","normal","index","getCentroidOfPolygon","polygon","signedArea","Cx","Cy","checkIfPolygonSelfIntersect","getAreaOfPolygon","A","sg","j","abs","addPopUp","text","frame","nf","push","handleEnemyDeathAndSplit","inter_index","health","o_health","spawned","t","e1","arr","oldCenterX","oldCenterY","copy_of_b","splice","newCenter","q","EnemyFromData","e2","newEnemy","handleCollision_Bullet_Enemy","b_x","b_y","inter_x","inter_y","inter_count","inter","xd","yd","max_v","_n","Enemy","o_x","o_y","min_v","min_r","max_r","nVertices","_a","EnemyPositionData","_maxR","_r","_health","positon_data","top","bottom","e","createPlayer","ax","vx","ay","vy","size","update","moveTo","lineTo","closePath","stroke","resetPlayer","drawEnemy","updateEnemy","drawPlayer","_player","save","translate","rotate","drawImage","restore","drawBullet","drawHealthBar","mid","strokeRect","fillRect","addEventListener","event","clientY","clientX","playerAccel","add","code","delete","includes","button","clear","oncontextmenu","location","reload","setup","draw","clearRect","fillText","squareDist","__l","player_x","player_y","filter","has","reset","requestAnimationFrame","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","protocol","ws","onmessage","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","hmrApply","v","hmrAcceptRun","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","remove","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"main.1f19ae8e.js","sourceRoot":"..\\src","sourcesContent":["let { sin, cos, atan2 } = Math;\r\n\r\nlet controlKey = {\r\n  up: [\"ArrowUp\", \"KeyW\"],\r\n  down: [\"ArrowDown\", \"KeyS\"],\r\n  left: [\"ArrowLeft\", \"KeyA\"],\r\n  right: [\"ArrowRight\", \"KeyD\"],\r\n  shoot: [\"KeyZ\", \"LeftMouse\"],\r\n  focus: [\"ShiftLeft\"],\r\n};\r\n\r\n//#region Global varibles\r\nlet canvas = document.getElementById(\"main-canvas\");\r\nlet c = canvas.getContext(\"2d\");\r\n\r\nlet c_width = window.screen.width;\r\nlet c_height = window.innerHeight;\r\ncanvas.width = c_width;\r\ncanvas.height = c_height;\r\ncanvas.style.background = \"#000000\";\r\nc.lineWidth = 3;\r\nc.strokeStyle = \"#ffffff\";\r\nc.fillStyle = \"#ffffff\";\r\nc.font = \"22px pressStart\";\r\n\r\nlet maxR = 300, //Maximun size of asteroid\r\n  minR = 40, //Minimun size of asteroid\r\n  minVertices = 7,\r\n  maxVertices = 25,\r\n  maxMapHeight = 7 * c_height, //Maximun scroll height\r\n  startMapLevel = 0, // Map's portion to start at\r\n  n_enemy = 15, // Number of enemy\r\n  bullet = [], // Array containing all bullet object\r\n  keyPressedPool = new Set(), // Set containing user's inputs\r\n  p_angle = 0, // Previous angle of player (Pointing to mouse)\r\n  angle = 0, // Angle of player (Pointing to mouse)\r\n  translate_x = 0, // Amount x to translate when player moves (Camera Follow)\r\n  translate_y = 0, // Amount y to translate when player moves (Camera Follow)\r\n  o_bulletTimer = 4, // Number of iteration before shooting bullet (bullet per 4 frames)\r\n  bulletTimer = 0, // Count ^\r\n  org_x = 0, // x of top left corner\r\n  org_y = 0, // y of top left corner\r\n  org_player_x = c_width / 2,\r\n  org_player_y = c_height / 1.5,\r\n  player_size = 30,\r\n  player,\r\n  enemy = [],\r\n  score = 0,\r\n  scoremult = 1,\r\n  popUps = [],\r\n  enemiesToShowHealth = {0:0};\r\n\r\nlet isEndless = 0,\r\n  isHardMode = 0;\r\n//#endregion\r\n\r\n//#region Setup Functions\r\n\r\n//#region Classes\r\nclass Bullet {\r\n  static bulletSpeed = 14;\r\n  constructor(x, y, r, _dir = { x: 0, y: -Bullet.bulletSpeed }) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.px = x;\r\n    this.py = y;\r\n    this.r = r;\r\n    this.img = (() => {\r\n      let can = document.createElement(\"canvas\");\r\n      let _c = can.getContext(\"2d\");\r\n      can.width = r * 2;\r\n      can.height = r * 2;\r\n      _c.fillStyle = \"#ffffff\";\r\n      _c.beginPath();\r\n      _c.arc(r, r, r, 0, 2 * Math.PI);\r\n      _c.fill();\r\n      return can;\r\n    })();\r\n    this.dir = _dir;\r\n    this.state = 1;\r\n    this.damage = 1;\r\n  }\r\n  update() {\r\n    this.x += this.dir.x;\r\n    this.y += this.dir.y;\r\n  }\r\n  reset(x, y, _dir = { x: 0, y: -Bullet.speed }) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.px = x;\r\n    this.py = y;\r\n    this.dir = _dir;\r\n    this.state = 1;\r\n    this.damage = 1;\r\n  }\r\n}\r\nlet bullet_start_dir = { x: 0, y: -Bullet.bulletSpeed }; // Starting position of bullet\r\n//#endregion\r\n\r\n//#region Misc Fucntions\r\nfunction ModifiedRandomAboveAvg() {\r\n  let x = Math.random();\r\n  return 4.5 * x ** 3 - 8.3 * x ** 2 + 4.8 * x;\r\n}\r\nfunction ModifiedRandomBelowAvg() {\r\n  let x = Math.random();\r\n  return 2.2 * x ** 3 - 3 * x ** 2 + 1.8 * x;\r\n}\r\nfunction getMaxMinCo_Enemy(_enemy) {\r\n  let x_arr = _enemy.data.map((a) => a.x - a.ox);\r\n  let x_max = Math.max(...x_arr),\r\n    x_min = Math.min(...x_arr);\r\n  let y_arr = _enemy.data.map((b) => b.y - b.oy);\r\n  let y_max = Math.max(...y_arr),\r\n    y_min = Math.min(...y_arr);\r\n\r\n  return {\r\n    xMax: x_max,\r\n    xMin: x_min,\r\n    yMax: y_max,\r\n    yMin: y_min,\r\n  };\r\n}\r\nfunction normalizeVector(_x, _y) {\r\n  let mag = Math.sqrt(_x ** 2 + _y ** 2);\r\n  return {\r\n    x: _x / mag,\r\n    y: _y / mag,\r\n  };\r\n}\r\nfunction checkCollision(x1, y1, x2, y2, x3, y3, x4, y4) {\r\n  let dem = (y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1);\r\n  let uA = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / dem;\r\n  let uB = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / dem;\r\n  if (uA >= 0 && uA <= 1 && uB >= 0 && uB <= 1) {\r\n    return {\r\n      x: x1 + uA * (x2 - x1),\r\n      y: y1 + uA * (y2 - y1),\r\n    };\r\n  }\r\n  return null;\r\n}\r\nfunction checkCollision_Bullet_Enemy(_bullet, _enemy) {\r\n  let xC = _bullet.x, yC = _bullet.y;\r\n  let minIndex = -1, minDistSq = 0, xM = 0, yM = 0, _nx = 0, _ny = 0;\r\n  for (let i = 0, l = _enemy.data.length; i !== l; i++) {\r\n    let xA = _enemy.data[i].x,\r\n      yA = _enemy.data[i].y,\r\n      xB = _enemy.data[(i + 1) % l].x,\r\n      yB = _enemy.data[(i + 1) % l].y;\r\n    let _an = yA - yB,  _bn = xB - xA,\r\n     a = -_an / _bn, b = (_an/_bn) * xA + yA,\r\n     _xM = (xC + a * yC - a * b) / (1 + a * a),\r\n     _yM = (a * a * yC + a*xC+b) / (1 + a * a);\r\n    let distSq = (_xM - xC) * (_xM - xC) + (_yM - yC) * (_yM - yC);\r\n    // c.beginPath();\r\n    // c.arc(_xM, _yM, 10, 0, 2*Math.PI);\r\n    // c.stroke();\r\n    if ((_xM < xA && _xM > xB) || (_xM > xA && _xM < xB)){\r\n      if (minIndex === -1) {\r\n        minIndex = i;\r\n        minDistSq = distSq;\r\n        (xM = _xM), (yM = _yM);\r\n        (_nx = yA - yB), (_ny = xB - xA);\r\n      } else if (distSq < minDistSq) {\r\n        minIndex = i;\r\n        minDistSq = distSq;\r\n        (xM = _xM), (yM = _yM);\r\n        (_nx = _an), (_ny = _bn);\r\n      }\r\n    }\r\n  }\r\n  let n = normalizeVector(_nx, _ny), IM = {\r\n    x: xM - xC,\r\n    y: yM - yC,\r\n  }\r\n  let dotP = IM.x * n.x + IM.y * n.y, m = 0;\r\n  if(minDistSq < _bullet.r * _bullet.r){\r\n    m = _bullet.r - Math.sqrt(minDistSq);\r\n    return {\r\n      x: xC - m * n.x,\r\n      y: yC - m * n.y,\r\n      normal: n,\r\n      index: minIndex,\r\n    };\r\n  }\r\n  return false\r\n}\r\nfunction getCentroidOfPolygon(polygon) {\r\n  let signedArea = 0,\r\n    Cx = 0,\r\n    Cy = 0;\r\n  for (let i = 0, l = polygon.length; i !== l; i++) {\r\n    let a =\r\n      polygon[i].x * polygon[(i + 1) % l].y -\r\n      polygon[(i + 1) % l].x * polygon[i].y;\r\n    signedArea += a;\r\n    Cx += (polygon[i].x + polygon[(i + 1) % l].x) * a;\r\n    Cy += (polygon[i].y + polygon[(i + 1) % l].y) * a;\r\n  }\r\n  signedArea *= 0.5;\r\n  let b = 1 / (6 * signedArea);\r\n  Cx *= b;\r\n  Cy *= b;\r\n  return {\r\n    x: Cx,\r\n    y: Cy,\r\n  };\r\n}\r\nfunction checkIfPolygonSelfIntersect(polygon) {\r\n  for (let i = 0, l = polygon.length; i !== l; i++) {\r\n    if (\r\n      checkCollision(\r\n        polygon[i].x,\r\n        polygon[i].y,\r\n        polygon[(i + 1) % l].x,\r\n        polygon[(i + 1) % l].y,\r\n        polygon[(i + 2) % l].x,\r\n        polygon[(i + 2) % l].y,\r\n        polygon[(i + 3) % l].x,\r\n        polygon[(i + 3) % l].y\r\n      )\r\n    ) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\nfunction getAreaOfPolygon(polygon) {\r\n  let A = 0, sg = 1;\r\n  for(let i = 0; i !== 2; i++){\r\n    for(let j = 0, l = polygon.length; j !== l; j++){\r\n      A += sg * polygon[(j + i) % l].x * polygon[(j + i + sg) % l].y;\r\n    }\r\n    sg = -1;\r\n  }\r\n  A = 0.5 * Math.abs(A);\r\n  return A;\r\n}\r\nfunction addPopUp(text, x, y, frame){\r\n  let nf = 1;\r\n  for(let i = 0; i < popUps.length; i++){\r\n    if(!popUps[i][3]){\r\n      popUps[i][0] = text;\r\n      popUps[i][1] = x;\r\n      popUps[i][2] = y;\r\n      popUps[i][3] = frame;\r\n      nf = 0\r\n      break;\r\n    }\r\n  }\r\n  if(nf) popUps.push([text, x, y, frame]);\r\n}\r\nfunction handleEnemyDeathAndSplit(_enemy, inter_index) {\r\n  //#region Enemy die and split\r\n  if (_enemy.health > 0) return; \r\n  _enemy.state = 0;\r\n  addPopUp(~~_enemy.o_health, _enemy.data[0].ox, _enemy.data[0].oy, 20);\r\n  score += _enemy.o_health * scoremult;\r\n  let spawned = 0;\r\n  let t =\r\n    (inter_index + 1 + ~~(_enemy.data.length / 2)) %\r\n    _enemy.data.length;\r\n  let a = inter_index + 1,\r\n    b = t, \r\n    e1;\r\n  let arr = _enemy.data;\r\n  let oldCenterX = arr[0].ox, oldCenterY = arr[0].oy;\r\n  let copy_of_b = { ...arr[b] };\r\n  if (a < b) {\r\n    e1 = arr.splice(\r\n      a,\r\n      b - a + 1,\r\n      {\r\n        ox: arr[0].ox,\r\n        oy: arr[0].oy,\r\n        x: arr[0].ox,\r\n        y: arr[0].oy,\r\n      },\r\n      copy_of_b\r\n    );\r\n  } else {\r\n    e1 = arr.splice(\r\n      b,\r\n      a - b ,\r\n      copy_of_b,\r\n      {\r\n        ox: arr[0].ox,\r\n        oy: arr[0].oy,\r\n        x: arr[0].ox,\r\n        y: arr[0].oy,\r\n      }\r\n    );\r\n  }\r\n  e1.push({\r\n    ox: arr[0].ox,\r\n    oy: arr[0].oy,\r\n    x: arr[0].ox,\r\n    y: arr[0].oy,\r\n  });\r\n  // console.log(e1.slice());\r\n  if (e1.length > 3 && !checkIfPolygonSelfIntersect(e1)) {\r\n    let newCenter = getCentroidOfPolygon(e1);\r\n    for (let i = 0; i < e1.length; i++) {\r\n      e1[i].ox = newCenter.x;\r\n      e1[i].oy = newCenter.y;\r\n    }\r\n    let q = 1;\r\n    for (let j = 0; j < _enemy.length; j++) {\r\n      if (_enemy[j].state) continue;\r\n      _enemy[j] = new EnemyFromData(e1, {\r\n        x: _enemy.dir.x + 2 * (e1[0].ox - oldCenterX) / _enemy.o_health,\r\n        y: _enemy.dir.y + 2 * (e1[0].oy - oldCenterY) / _enemy.o_health,\r\n      });\r\n      if (getAreaOfPolygon(_enemy[j].data) < 1800) {\r\n        _enemy[j].state = 0;\r\n        spawned--;\r\n      }\r\n      q = 0;\r\n      break;\r\n    }\r\n    if (q) {\r\n      enemy.push(\r\n        new EnemyFromData(e1, {\r\n          x: _enemy.dir.x + 2 * (e1[0].ox - oldCenterX) / _enemy.o_health,\r\n          y: _enemy.dir.y + 2 * (e1[0].oy - oldCenterY) / _enemy.o_health,\r\n        })\r\n      );\r\n      if (getAreaOfPolygon(enemy[enemy.length - 1].data) < 1800) {\r\n        enemy[enemy.length - 1].state = 0;\r\n        spawned--;\r\n      }\r\n    }\r\n    spawned++;\r\n  }\r\n  let e2 = arr;\r\n  if (e2.length > 3 && !checkIfPolygonSelfIntersect(e2)) {\r\n    let newCenter = getCentroidOfPolygon(e2);\r\n    for (let i = 0; i < e2.length; i++) {\r\n      e2[i].ox = newCenter.x;\r\n      e2[i].oy = newCenter.y;\r\n    }\r\n    let q = 1;\r\n    for (let j = 0; j < _enemy.length; j++) {\r\n      if (_enemy[j].state) continue\r\n      _enemy[j] = new EnemyFromData(e2, {\r\n        x:\r\n          _enemy.dir.x +\r\n          (2 * (e2[0].ox - oldCenterX)) / _enemy.o_health,\r\n        y:\r\n          _enemy.dir.y +\r\n          (2 * (e2[0].oy - oldCenterY)) / _enemy.o_health,\r\n      });\r\n      if (getAreaOfPolygon(_enemy[j].data) < 1800) {\r\n        _enemy[j].state = 0;\r\n        spawned--;\r\n      }\r\n      q = 0;\r\n      break;\r\n    }\r\n    if (q) {\r\n      enemy.push(\r\n        new EnemyFromData(e2, {\r\n          x:\r\n            _enemy.dir.x +\r\n            (2 * (e2[0].ox - oldCenterX)) / _enemy.o_health,\r\n          y:\r\n            _enemy.dir.y +\r\n            (2 * (e2[0].oy - oldCenterY)) / _enemy.o_health,\r\n        })\r\n      );\r\n      if (getAreaOfPolygon(enemy[enemy.length - 1].data) < 1800) {\r\n        enemy[enemy.length - 1].state = 0;\r\n        spawned--;\r\n      }\r\n    }\r\n    spawned++;\r\n  }\r\n\r\n  if (isEndless && !spawned) {\r\n    let q = 1;\r\n    for (let j = 0; j < enemy.length; j++) {\r\n      if (!enemy[j].state) {\r\n        enemy[j] = newEnemy();\r\n        q = 0;\r\n        break;\r\n      }\r\n    }\r\n    if (q) enemy.push(newEnemy());\r\n  }\r\n  //#endregion\r\n}\r\nfunction handleCollision_Bullet_Enemy(bullet, _enemy) {\r\n  let b_x = bullet.x,\r\n    b_y = bullet.y;\r\n  let inter_x,\r\n    inter_y,\r\n    inter_count = 0,\r\n    inter_index = 0,\r\n    n;\r\n  for (let j = 0, l = _enemy.data.length; j !== l; j++) {\r\n    let x3 = _enemy.data[j].x,\r\n      y3 = _enemy.data[j].y,\r\n      x4 = _enemy.data[(j + 1) % l].x,\r\n      y4 = _enemy.data[(j + 1) % l].y;\r\n    //#region Check how many collision\r\n    let inter = checkCollision(\r\n      b_x,\r\n      b_y,\r\n      bullet.px + _enemy.dir.x,\r\n      bullet.py + _enemy.dir.y,\r\n      x3,\r\n      y3,\r\n      x4,\r\n      y4\r\n    );\r\n    if (inter) {\r\n      inter_index = j;\r\n      inter_count++;\r\n      n = normalizeVector(y3 - y4, x4 - x3);\r\n      inter_x = inter.x;\r\n      inter_y = inter.y;\r\n    }\r\n    //#endregion\r\n  }\r\n  if (inter_count === 1) {\r\n    //#region IF HIT\r\n    let xd = bullet.dir.x,\r\n      yd = bullet.dir.y;\r\n    let t = n.x * xd + n.y * yd;\r\n    if (t >= 0) {\r\n      bullet.dir.x -= 2 * n.x * t - _enemy.dir.x;\r\n      bullet.dir.y -= 2 * n.y * t - _enemy.dir.y;\r\n    } else {\r\n      bullet.dir.x += _enemy.dir.x;\r\n      bullet.dir.y += _enemy.dir.y;\r\n    }\r\n\r\n    _enemy.dir.x +=\r\n      (_enemy.dir.x < player.max_v - 2) *\r\n      (xd - bullet.dir.x) *\r\n      (50 / _enemy.maxR ** 2);\r\n    _enemy.dir.y +=\r\n      (_enemy.dir.y < player.max_v - 2) *\r\n      (yd - bullet.dir.y) *\r\n      (50 / _enemy.maxR ** 2);\r\n    let _n = normalizeVector(bullet.dir.x, bullet.dir.y);\r\n    1;\r\n    bullet.x = inter_x + _n.x * 0.1;\r\n    bullet.y = inter_y + _n.y * 0.1;\r\n    // bullet.dir.x *= 0.9;\r\n    // bullet.dir.y *= 0.9;\r\n\r\n    _enemy.health -= bullet.damage;\r\n    score += bullet.damage * scoremult;\r\n    addPopUp(~~(bullet.damage * 10) / 10, inter_x, inter_y, 10);\r\n    bullet.damage *= Math.sqrt(\r\n      (bullet.dir.x ** 2 + bullet.dir.y ** 2) / (xd**2 + yd**2)\r\n    );\r\n    //#endregion\r\n    handleEnemyDeathAndSplit(_enemy, inter_index)\r\n    \r\n  } else if (inter_count !== 0) {\r\n    bullet.state = 0;\r\n    _enemy.health-= bullet.damage;\r\n    score += bullet.damage * scoremult;\r\n  }\r\n  //#endregion\r\n\r\n}\r\n//#endregion\r\n\r\n//#region Creating Enemy\r\nfunction Enemy(\r\n  o_x,\r\n  o_y,\r\n  min_v = 5,\r\n  max_v = 10,\r\n  min_r = 20,\r\n  max_r = 40,\r\n  _dir = { _x: 0, _y: 0 }\r\n) {\r\n  let nVertices = min_v + ~~(Math.random() * (max_v - min_v));\r\n  let _a = (2 * Math.PI) / nVertices;\r\n  let EnemyPositionData = [];\r\n  let _maxR = 0;\r\n  for (let i = 0; i < nVertices; i++) {\r\n    let _r = min_r + ModifiedRandomAboveAvg() * (max_r - min_r);\r\n    if (_r > _maxR) _maxR = _r;\r\n    EnemyPositionData.push({\r\n      ox: o_x,\r\n      oy: o_y,\r\n      x: o_x + _r * cos(i * _a),\r\n      y: o_y + _r * sin(i * _a),\r\n    });\r\n  }\r\n  let newCenter = getCentroidOfPolygon(EnemyPositionData);\r\n  for (let i = 0; i < EnemyPositionData.length; i++) {\r\n    EnemyPositionData[i].ox = newCenter.x;\r\n    EnemyPositionData[i].oy = newCenter.y;\r\n  }\r\n  let _health = ~~(getAreaOfPolygon(EnemyPositionData) / 300);\r\n  return {\r\n    data: EnemyPositionData,\r\n    dir: {\r\n      x: _dir._x,\r\n      y: _dir._y,\r\n    },\r\n    maxR: _maxR,\r\n    health: _health,\r\n    o_health: _health,\r\n    state: 1,\r\n  };\r\n}\r\nfunction EnemyFromData(positon_data, _dir = { x: 2, y: 0 }) {\r\n  let _enemy = {\r\n    data: positon_data,\r\n    dir: _dir,\r\n    state: 1,\r\n  };\r\n  let a = getMaxMinCo_Enemy(_enemy);\r\n  _enemy.top = a.yMin + _enemy.data[0].oy;\r\n  _enemy.bottom = a.yMax + _enemy.data[0].oy;\r\n  _enemy.right = a.xMax + _enemy.data[0].ox;\r\n  _enemy.left = a.xMin + _enemy.data[0].ox;\r\n  _enemy.maxR = Math.sqrt(\r\n    ((a.xMax - a.xMin) / 2) ** 2 + ((a.yMax - a.yMin) / 2) ** 2\r\n  );\r\n  let _health = ~~(getAreaOfPolygon(positon_data) / 300);\r\n  _enemy.health = _health;\r\n  _enemy.o_health = _health;\r\n  return _enemy;\r\n}\r\nfunction newEnemy() {\r\n  let _r = minR + ModifiedRandomBelowAvg() * (maxR - minR);\r\n  let e = new Enemy(\r\n    maxR + Math.random() * (c_width - maxR),\r\n    -(maxMapHeight - startMapLevel * c_height) + maxMapHeight * Math.random(),\r\n    minVertices,\r\n    maxVertices,\r\n    _r / 4,\r\n    _r,\r\n    {\r\n      _x: -6 + Math.random() * 12,\r\n      _y: -6 + Math.random() * 12,\r\n    }\r\n  );\r\n  let a = getMaxMinCo_Enemy(e);\r\n  e.top = a.yMin + e.data[0].oy;\r\n  e.bottom = a.yMax + e.data[0].oy;\r\n  e.right = a.xMax + e.data[0].ox;\r\n  e.left = a.xMin + e.data[0].ox;\r\n  return e;\r\n}\r\n//#endregion\r\n\r\n//#region Creating Player\r\nfunction createPlayer() {\r\n  return {\r\n    px: org_player_x,\r\n    py: org_player_y,\r\n    x: org_player_x,\r\n    y: org_player_y,\r\n    ax: 0,\r\n    vx: 0,\r\n    ay: 0,\r\n    vy: 0,\r\n    max_v: 8,\r\n    size: player_size,\r\n    update: function () {\r\n      this.vx += this.ax * (Math.abs(this.vx) <= this.max_v);\r\n      this.x +=\r\n        this.vx *\r\n        ((this.x > org_x || this.vx > 0) &&\r\n          (this.x < org_x + c_width || this.vx < 0));\r\n      this.vy += this.ay * (Math.abs(this.vy) <= this.max_v);\r\n      this.y += this.vy;\r\n\r\n      this.vx *= 0.8;\r\n      this.vy *= 0.8;\r\n    },\r\n    img: (() => {\r\n      let can = document.createElement(\"canvas\");\r\n      let _c = can.getContext(\"2d\");\r\n      can.width = player_size;\r\n      can.height = player_size;\r\n      _c.fillStyle = \"#ffffff\";\r\n      _c.strokeStyle = \"#ffffff\";\r\n      _c.beginPath();\r\n      _c.moveTo(can.width / 2, 0);\r\n      _c.lineTo(can.width, can.height);\r\n      _c.lineTo(can.width / 2, can.height / 2);\r\n      _c.lineTo(0, can.height);\r\n      _c.closePath();\r\n      _c.stroke();\r\n      _c.fill();\r\n      return can;\r\n    })(),\r\n  };\r\n}\r\nfunction resetPlayer() {\r\n  let px = player.x;\r\n  let py = player.y;\r\n\r\n  player = createPlayer();\r\n  player.px = px;\r\n  player.py = py;\r\n}\r\n//#endregion\r\n//#endregion\r\n\r\n//#region Update and Drawing Functions\r\nfunction drawEnemy(_enemy) {\r\n  c.beginPath();\r\n  c.moveTo(_enemy.data[0].x, _enemy.data[0].y);\r\n  for (let i = 1; i < _enemy.data.length; i++) {\r\n    c.lineTo(_enemy.data[i].x, _enemy.data[i].y);\r\n  }\r\n  c.closePath();\r\n  c.stroke();\r\n  // c.fill();\r\n}\r\nfunction updateEnemy(_enemy) {\r\n  let a = _enemy.dir.x,\r\n    b = _enemy.dir.y;\r\n  for (let i = 0; i < _enemy.data.length; i++) {\r\n    _enemy.data[i].x += a;\r\n    _enemy.data[i].y += b;\r\n    _enemy.data[i].ox += a;\r\n    _enemy.data[i].oy += b;\r\n  }\r\n  _enemy.right += a;\r\n  _enemy.top += b;\r\n  _enemy.left += a;\r\n  _enemy.bottom += b;\r\n  _enemy.dir.x *= 0.9999;\r\n  _enemy.dir.y *= 0.9999;\r\n}\r\nfunction drawPlayer(_player) {\r\n  c.save();\r\n  c.translate(_player.x, _player.y);\r\n  c.rotate(angle);\r\n  c.drawImage(_player.img, -_player.size / 2, -_player.size / 2);\r\n  c.restore();\r\n}\r\nfunction drawBullet(_bullet) {\r\n  c.drawImage(_bullet.img, _bullet.x - _bullet.r, _bullet.y - _bullet.r);\r\n}\r\nfunction drawHealthBar(_enemy) {\r\n  let mid = (_enemy.left + _enemy.right) / 2\r\n  c.strokeRect(mid - 50, _enemy.bottom + 10,100,10);\r\n  c.fillRect(mid - 50, _enemy.bottom + 10, (_enemy.health / _enemy.o_health) * 100, 10);\r\n}\r\n//#endregion\r\n\r\n//#region Event Handling\r\n\r\ncanvas.addEventListener(\"mousemove\", (event) => {\r\n  p_angle = angle;\r\n  angle =\r\n    atan2(\r\n      event.clientY + org_y - player.y,\r\n      event.clientX + org_x - player.x\r\n    ) +\r\n    Math.PI / 2;\r\n  bullet_start_dir.x = Bullet.bulletSpeed * sin(angle);\r\n  bullet_start_dir.y = -Bullet.bulletSpeed * cos(angle);\r\n  // console.log(angle * 180 / Math.PI);\r\n});\r\nlet playerAccel = 2;\r\ndocument.addEventListener(\"keydown\", (event) => {\r\n  keyPressedPool.add(event.code);\r\n});\r\ndocument.addEventListener(\"keyup\", (event) => {\r\n  keyPressedPool.delete(event.code);\r\n  if (\r\n    controlKey.left.includes(event.code) ||\r\n    controlKey.right.includes(event.code)\r\n  )\r\n    player.ax = 0;\r\n  if (\r\n    controlKey.up.includes(event.code) ||\r\n    controlKey.down.includes(event.code)\r\n  )\r\n    player.ay = 0;\r\n});\r\ndocument.addEventListener(\"mousedown\", (event) => {\r\n  if (event.button === 0) keyPressedPool.add(\"LeftMouse\");\r\n});\r\ndocument.addEventListener(\"mouseup\", (event) => {\r\n  if (event.button === 0) keyPressedPool.delete(\"LeftMouse\");\r\n});\r\ndocument.addEventListener(\"visibilitychange\", () => {\r\n  keyPressedPool.clear();\r\n  player.ax = 0;\r\n  player.ay = 0;\r\n});\r\ndocument.oncontextmenu = () => false;\r\nwindow.addEventListener(\"resize\", () => {\r\n  if (window.innerHeight !== c_height) {\r\n    location.reload();\r\n  }\r\n});\r\n\r\n//#endregion\r\n\r\n//#region Set up\r\nfunction setup(){\r\n  score = 0; \r\n  enemy = [\r\n    (() => {\r\n      let _r = minR + ModifiedRandomBelowAvg() * (maxR - minR);\r\n      let e = Enemy(\r\n        c_width / 2,\r\n        c_height / 5,\r\n        minVertices,\r\n        maxVertices,\r\n        _r / 4,\r\n        _r,\r\n        {\r\n          _x: -1 + Math.random() * 2,\r\n          _y: -1 + Math.random() * 2,\r\n        }\r\n      );\r\n      let a = getMaxMinCo_Enemy(e);\r\n      e.top = a.yMin + e.data[0].oy;\r\n      e.bottom = a.yMax + e.data[0].oy;\r\n      e.right = a.xMax + e.data[0].ox;\r\n      e.left = a.xMin + e.data[0].ox;\r\n      return e;\r\n    })(),\r\n  ];\r\n  for (let i = 1; i < n_enemy; i++) {\r\n    enemy.push(newEnemy());\r\n  }\r\n  player = createPlayer();\r\n}\r\nsetup();\r\n//#endregion\r\n\r\n//#region Main Loop\r\n// _________________MAIN_LOOP_________________\r\nfunction draw() {\r\n  player.py = player.y;\r\n  player.px = player.x;\r\n\r\n  player.update();\r\n  c.clearRect(org_x, org_y, c_width, c_height);\r\n\r\n  //#region Draw Stuffs\r\n  for (let i = 0; i < enemy.length; i++) {\r\n    if (enemy[i].state) updateEnemy(enemy[i]);\r\n  }\r\n  for (let i = 0; i < enemy.length; i++) {\r\n    if (enemy[i].state) {\r\n      drawEnemy(enemy[i]);\r\n    }\r\n  }\r\n  drawPlayer(player);\r\n  c.fillText(`Score(x${scoremult}):${~~score}`, org_x + 10, org_y + 32);\r\n  for(let i = 0; i < popUps.length; i++){\r\n    if(popUps[i][3] !== 0){\r\n      c.fillText(\r\n        popUps[i][0],\r\n        popUps[i][1],\r\n        popUps[i][2]\r\n      );\r\n      popUps[i][3]--;\r\n      popUps[i][2]-= 7;\r\n    }\r\n  }\r\n  for(let i in enemiesToShowHealth){\r\n    if(enemiesToShowHealth[i] === 0 ||!enemy[i].state){\r\n      delete enemiesToShowHealth[i];\r\n      continue;\r\n    }\r\n    drawHealthBar(enemy[i]);\r\n    enemiesToShowHealth[i]--;\r\n  }\r\n  // enemiesToShowHealth.clear();\r\n  //#endregion\r\n\r\n  //#region Enemy Wrap Around\r\n  for (let i = 0; i !== enemy.length; i++) {\r\n    let left = enemy[i].left;\r\n    let right = enemy[i].right;\r\n    let top = enemy[i].top;\r\n    let bottom = enemy[i].bottom;\r\n    if (left > org_x + c_width) {\r\n      let a = right - org_x;\r\n      enemy[i].left -= a;\r\n      enemy[i].right -= a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].x -= a;\r\n        enemy[i].data[j].ox -= a;\r\n      }\r\n    } else if (right < org_x) {\r\n      let a = c_width + org_x - left;\r\n      enemy[i].left += a;\r\n      enemy[i].right += a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].x += a;\r\n        enemy[i].data[j].ox += a;\r\n      }\r\n    }\r\n    if (bottom < -maxMapHeight) {\r\n      let a = c_height - top;\r\n      enemy[i].top += a;\r\n      enemy[i].bottom += a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].y += a;\r\n        enemy[i].data[j].oy += a;\r\n      }\r\n    } else if (top > c_height) {\r\n      let a = maxMapHeight + bottom;\r\n      enemy[i].top -= a;\r\n      enemy[i].bottom -= a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].y -= a;\r\n        enemy[i].data[j].oy -= a;\r\n      }\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Draw bullets & Collision detection between bullets & others\r\n  for (let i = 0; i < bullet.length; i++) {\r\n    if (bullet[i].state) {\r\n      drawBullet(bullet[i]);\r\n      bullet[i].px = bullet[i].x;\r\n      bullet[i].py = bullet[i].y;\r\n      bullet[i].update();\r\n\r\n      let b_x = bullet[i].x,\r\n        b_y = bullet[i].y;\r\n      //#region Player Collision Detection\r\n      if(isHardMode){\r\n        let squareDist = (player.x - b_x) ** 2 + (player.y - b_y) ** 2;\r\n        if (squareDist <= (player.size / 3 + bullet[i].r) ** 2) {\r\n          resetPlayer(player);\r\n        }\r\n      }\r\n      //#endregion\r\n\r\n      //#region Enemy Collsion Detection\r\n      for (let m = 0, __l = enemy.length; m !== __l; m++) {\r\n        if (!enemy[m].state) continue;\r\n        if (\r\n          !(\r\n            b_x > enemy[m].left - 10 &&\r\n            b_x < enemy[m].right + 10 &&\r\n            b_y < enemy[m].bottom + 10 &&\r\n            b_y > enemy[m].top - 10\r\n          )\r\n        ) continue;\r\n        enemiesToShowHealth[m] = 10;\r\n        handleCollision_Bullet_Enemy(bullet[i], enemy[m]);\r\n      }\r\n      //#endregion\r\n\r\n      if (\r\n        b_y < org_y - bullet[i].r ||\r\n        b_y > org_y + c_height ||\r\n        b_x < org_x ||\r\n        b_x > org_x + c_width ||\r\n        Math.sqrt(bullet[i].dir.x ** 2 + bullet[i].dir.y ** 2) < 0.65\r\n      ) {\r\n        bullet[i].state = 0;\r\n        continue;\r\n      }\r\n      // drawBullet(bullet[i]);\r\n    }\r\n  }\r\n  //#endregion\r\n  \r\n  //#region Player collision with enemies\r\n  for (let m = 0, __l = enemy.length; m !== __l; m++) {\r\n    if (!enemy[m].state) continue;\r\n    let player_x = player.x, player_y = player.y;\r\n    if (\r\n      player_x > enemy[m].left - 10 &&\r\n      player_x < enemy[m].right + 10 &&\r\n      player_y < enemy[m].bottom + 10 &&\r\n      player_y > enemy[m].top - 10\r\n    ) {\r\n      for (let j = 0, l = enemy[m].data.length; j !== l; j++) {\r\n        let x3 = enemy[m].data[j].x,\r\n          y3 = enemy[m].data[j].y,\r\n          x4 = enemy[m].data[(j + 1) % l].x,\r\n          y4 = enemy[m].data[(j + 1) % l].y;\r\n        if (checkCollision(\r\n          player_x,\r\n          player_y,\r\n          player.px + enemy[m].dir.x,\r\n          player.py + enemy[m].dir.y,\r\n          x3,\r\n          y3,\r\n          x4,\r\n          y4\r\n        )) {\r\n          resetPlayer(player);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Camera moves with player\r\n  if (player.py !== player.y || player.px !== player.x) {\r\n    translate_x = (player.px - player.x) * 0.1;\r\n    translate_y = player.py - player.y;\r\n    org_x -= translate_x;\r\n    if (player.y >= org_player_y) translate_y = org_y;\r\n    else if (player.y <= -maxMapHeight + org_player_y)\r\n      translate_y = org_y + maxMapHeight;\r\n\r\n    org_y -= translate_y;\r\n    c.translate(translate_x, translate_y);\r\n  }\r\n  //#endregion\r\n\r\n  //#region Input check\r\n  if (keyPressedPool.size) {\r\n    if (controlKey.focus.filter((x) => keyPressedPool.has(x)).length) {\r\n      player.max_v = 4;\r\n      o_bulletTimer = 2;\r\n    } else {\r\n      player.max_v = 8;\r\n      o_bulletTimer = 4;\r\n    }\r\n\r\n    if (controlKey.up.filter((x) => keyPressedPool.has(x)).length)\r\n      player.ay = -playerAccel;\r\n    if (controlKey.down.filter((x) => keyPressedPool.has(x)).length)\r\n      player.ay = playerAccel;\r\n    if (controlKey.left.filter((x) => keyPressedPool.has(x)).length)\r\n      player.ax = -playerAccel;\r\n    if (controlKey.right.filter((x) => keyPressedPool.has(x)).length)\r\n      player.ax = playerAccel;\r\n    if (controlKey.shoot.filter((x) => keyPressedPool.has(x)).length) {\r\n      if (!bulletTimer) {\r\n        let n = 1;\r\n        for (let i = 0; i < bullet.length; i++) {\r\n          if (!bullet[i].state) {\r\n            bullet[i].reset(\r\n              player.x + (player.size / 2) * cos(angle - Math.PI / 2),\r\n              player.y + (player.size / 2) * sin(angle - Math.PI / 2),\r\n              { ...bullet_start_dir }\r\n            );\r\n            n = 0;\r\n            break;\r\n          }\r\n        }\r\n        if (n)\r\n          bullet.push(\r\n            new Bullet(\r\n              player.x + (player.size / 2) * cos(angle - Math.PI / 2),\r\n              player.y + (player.size / 2) * sin(angle - Math.PI / 2),\r\n              5,\r\n              { ...bullet_start_dir }\r\n            )\r\n          );\r\n        bulletTimer = o_bulletTimer;\r\n      } else bulletTimer--;\r\n    }\r\n  }\r\n  //#endregion\r\n  requestAnimationFrame(draw);\r\n}\r\ndraw();\r\n//#endregion\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}