{"version":3,"sources":["main.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["sin","Math","cos","atan2","controlKey","up","down","left","right","shoot","focus","canvas","document","getElementById","c","getContext","c_width","window","screen","width","c_height","innerHeight","height","style","background","lineWidth","strokeStyle","fillStyle","font","maxR","minR","minVertices","maxVertices","maxMapHeight","startMapLevel","n_enemy","bullet","keyPressedPool","Set","p_angle","angle","translate_x","translate_y","o_bulletTimer","bulletTimer","org_x","org_y","org_player_x","org_player_y","player_size","player","enemy","score","scoremult","popUps","enemiesToShowHealth","enemyInView","maxBurstAmmount","isEndless","isHardMode","Bullet","x","y","r","_dir","bulletSpeed","px","py","img","can","createElement","_c","beginPath","arc","PI","fill","dir","state","damage","speed","bullet_start_dir","ModifiedRandomAboveAvg","random","ModifiedRandomBelowAvg","getMaxMinCo_Enemy","_enemy","x_arr","data","map","a","ox","x_max","max","x_min","min","y_arr","b","oy","y_max","y_min","xMax","xMin","yMax","yMin","normalizeVector","_x","_y","mag","sqrt","checkCollision","x1","y1","x2","y2","x3","y3","x4","y4","dem","uA","uB","checkCollision_Bullet_Enemy","_bullet","xC","yC","minIndex","minDistSq","xM","yM","_nx","_ny","i","l","length","xA","yA","xB","yB","_an","_bn","_xM","_yM","distSq","n","IM","dotP","m","normal","index","getCentroidOfPolygon","polygon","signedArea","Cx","Cy","checkIfPolygonSelfIntersect","getAreaOfPolygon","A","sg","j","abs","addPopUp","text","frame","nf","push","handleEnemyDeathAndSplit","inter_index","health","o_health","spawned","t","e1","arr","oldCenterX","oldCenterY","copy_of_b","splice","newCenter","q","EnemyFromData","e2","newRandomEnemy","handleCollision_Bullet_Enemy","b_x","b_y","inter_x","inter_y","inter_count","inter","xd","yd","max_v","_n","shootBullet","reset","size","ax","ay","burstBullet","Enemy","o_x","o_y","min_v","min_r","max_r","nVertices","_a","EnemyPositionData","_maxR","_r","_health","positon_data","top","bottom","e","createPlayer","vx","vy","update","moveTo","lineTo","closePath","stroke","resetPlayer","drawEnemy","updateEnemy","drawPlayer","_player","save","translate","rotate","drawImage","restore","drawBullet","drawHealthBar","mid","strokeRect","fillRect","addEventListener","event","clientY","clientX","playerAccel","add","code","delete","button","clear","oncontextmenu","location","reload","setup","draw","clearRect","fillText","squareDist","__l","player_x","player_y","some","has","requestAnimationFrame","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","protocol","ws","onmessage","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","hmrApply","v","hmrAcceptRun","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","remove","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","cb"],"mappings":"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","file":"main.1f19ae8e.js","sourceRoot":"..\\src","sourcesContent":["let { sin, cos, atan2 } = Math;\r\n\r\nlet controlKey = {\r\n  up: [\"ArrowUp\", \"KeyW\"],\r\n  down: [\"ArrowDown\", \"KeyS\"],\r\n  left: [\"ArrowLeft\", \"KeyA\"],\r\n  right: [\"ArrowRight\", \"KeyD\"],\r\n  shoot: [\"KeyZ\", \"LeftMouse\"],\r\n  focus: [\"ShiftLeft\"],\r\n};\r\n\r\n//#region Global varibles\r\nlet canvas = document.getElementById(\"main-canvas\");\r\nlet c = canvas.getContext(\"2d\");\r\n\r\nlet c_width = window.screen.width;\r\nlet c_height = window.innerHeight;\r\ncanvas.width = c_width;\r\ncanvas.height = c_height;\r\ncanvas.style.background = \"#000000\";\r\nc.lineWidth = 3;\r\nc.strokeStyle = \"#ffffff\";\r\nc.fillStyle = \"#ffffff\";\r\nc.font = \"22px pressStart\";\r\n\r\nlet maxR = 300, //Maximun size of asteroid\r\n  minR = 40, //Minimun size of asteroid\r\n  minVertices = 7,\r\n  maxVertices = 25,\r\n  maxMapHeight = 7 * c_height, //Maximun scroll height\r\n  startMapLevel = 0, // Map's portion to start at\r\n  n_enemy = 15, // Number of enemy\r\n  bullet = [], // Array containing all bullet object\r\n  keyPressedPool = new Set(), // Set containing user's inputs\r\n  p_angle = 0, // Previous angle of player (Pointing to mouse)\r\n  angle = 0, // Angle of player (Pointing to mouse)\r\n  translate_x = 0, // Amount x to translate when player moves (Camera Follow)\r\n  translate_y = 0, // Amount y to translate when player moves (Camera Follow)\r\n  o_bulletTimer = 4, // Number of iteration before shooting bullet (bullet per 4 frames)\r\n  bulletTimer = 0, // Count ^\r\n  org_x = 0, // x of top left corner\r\n  org_y = 0, // y of top left corner\r\n  org_player_x = c_width / 2,\r\n  org_player_y = c_height / 1.5,\r\n  player_size = 30,\r\n  player,\r\n  enemy = [],\r\n  score = 0,\r\n  scoremult = 1,\r\n  popUps = [],\r\n  enemiesToShowHealth = { 0: 0 },\r\n  enemyInView = new Set(),\r\n  maxBurstAmmount = 20;\r\n\r\nlet isEndless = 0,\r\n  isHardMode = 0;\r\n//#endregion\r\n\r\n//#region Setup Functions\r\n\r\n//#region Classes\r\nclass Bullet {\r\n  static bulletSpeed = 14;\r\n  constructor(x, y, r, _dir = { x: 0, y: -Bullet.bulletSpeed }) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.px = x;\r\n    this.py = y;\r\n    this.r = r;\r\n    this.img = (() => {\r\n      let can = document.createElement(\"canvas\");\r\n      let _c = can.getContext(\"2d\");\r\n      can.width = r * 2;\r\n      can.height = r * 2;\r\n      _c.fillStyle = \"#ffffff\";\r\n      _c.beginPath();\r\n      _c.arc(r, r, r, 0, 2 * Math.PI);\r\n      _c.fill();\r\n      return can;\r\n    })();\r\n    this.dir = _dir;\r\n    this.state = 1;\r\n    this.damage = 1;\r\n  }\r\n  update() {\r\n    this.x += this.dir.x;\r\n    this.y += this.dir.y;\r\n  }\r\n  reset(x, y, _dir = { x: 0, y: -Bullet.speed }) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.px = x;\r\n    this.py = y;\r\n    this.dir = _dir;\r\n    this.state = 1;\r\n    this.damage = 1;\r\n  }\r\n}\r\nlet bullet_start_dir = { x: 0, y: -Bullet.bulletSpeed }; // Starting position of bullet\r\n//#endregion\r\n\r\n//#region Misc Fucntions\r\nfunction ModifiedRandomAboveAvg() {\r\n  let x = Math.random();\r\n  return 4.5 * x ** 3 - 8.3 * x ** 2 + 4.8 * x;\r\n}\r\nfunction ModifiedRandomBelowAvg() {\r\n  let x = Math.random();\r\n  return 2.2 * x ** 3 - 3 * x ** 2 + 1.8 * x;\r\n}\r\nfunction getMaxMinCo_Enemy(_enemy) {\r\n  let x_arr = _enemy.data.map((a) => a.x - a.ox);\r\n  let x_max = Math.max(...x_arr),\r\n    x_min = Math.min(...x_arr);\r\n  let y_arr = _enemy.data.map((b) => b.y - b.oy);\r\n  let y_max = Math.max(...y_arr),\r\n    y_min = Math.min(...y_arr);\r\n\r\n  return {\r\n    xMax: x_max,\r\n    xMin: x_min,\r\n    yMax: y_max,\r\n    yMin: y_min,\r\n  };\r\n}\r\nfunction normalizeVector(_x, _y) {\r\n  let mag = Math.sqrt(_x ** 2 + _y ** 2);\r\n  return {\r\n    x: _x / mag,\r\n    y: _y / mag,\r\n  };\r\n}\r\nfunction checkCollision(x1, y1, x2, y2, x3, y3, x4, y4) {\r\n  let dem = (y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1);\r\n  let uA = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / dem;\r\n  let uB = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / dem;\r\n  if (uA >= 0 && uA <= 1 && uB >= 0 && uB <= 1) {\r\n    return {\r\n      x: x1 + uA * (x2 - x1),\r\n      y: y1 + uA * (y2 - y1),\r\n    };\r\n  }\r\n  return null;\r\n}\r\nfunction checkCollision_Bullet_Enemy(_bullet, _enemy) {\r\n  let xC = _bullet.x,\r\n    yC = _bullet.y;\r\n  let minIndex = -1,\r\n    minDistSq = 0,\r\n    xM = 0,\r\n    yM = 0,\r\n    _nx = 0,\r\n    _ny = 0;\r\n  for (let i = 0, l = _enemy.data.length; i !== l; i++) {\r\n    let xA = _enemy.data[i].x,\r\n      yA = _enemy.data[i].y,\r\n      xB = _enemy.data[(i + 1) % l].x,\r\n      yB = _enemy.data[(i + 1) % l].y;\r\n    let _an = yA - yB,\r\n      _bn = xB - xA,\r\n      a = -_an / _bn,\r\n      b = (_an / _bn) * xA + yA,\r\n      _xM = (xC + a * yC - a * b) / (1 + a * a),\r\n      _yM = (a * a * yC + a * xC + b) / (1 + a * a);\r\n    let distSq = (_xM - xC) * (_xM - xC) + (_yM - yC) * (_yM - yC);\r\n    // c.beginPath();\r\n    // c.arc(_xM, _yM, 10, 0, 2*Math.PI);\r\n    // c.stroke();\r\n    if ((_xM < xA && _xM > xB) || (_xM > xA && _xM < xB)) {\r\n      if (minIndex === -1) {\r\n        minIndex = i;\r\n        minDistSq = distSq;\r\n        (xM = _xM), (yM = _yM);\r\n        (_nx = yA - yB), (_ny = xB - xA);\r\n      } else if (distSq < minDistSq) {\r\n        minIndex = i;\r\n        minDistSq = distSq;\r\n        (xM = _xM), (yM = _yM);\r\n        (_nx = _an), (_ny = _bn);\r\n      }\r\n    }\r\n  }\r\n  let n = normalizeVector(_nx, _ny),\r\n    IM = {\r\n      x: xM - xC,\r\n      y: yM - yC,\r\n    };\r\n  let dotP = IM.x * n.x + IM.y * n.y,\r\n    m = 0;\r\n  if (minDistSq < _bullet.r * _bullet.r) {\r\n    m = _bullet.r - Math.sqrt(minDistSq);\r\n    return {\r\n      x: xC - m * n.x,\r\n      y: yC - m * n.y,\r\n      normal: n,\r\n      index: minIndex,\r\n    };\r\n  }\r\n  return false;\r\n}\r\nfunction getCentroidOfPolygon(polygon) {\r\n  let signedArea = 0,\r\n    Cx = 0,\r\n    Cy = 0;\r\n  for (let i = 0, l = polygon.length; i !== l; i++) {\r\n    let a =\r\n      polygon[i].x * polygon[(i + 1) % l].y -\r\n      polygon[(i + 1) % l].x * polygon[i].y;\r\n    signedArea += a;\r\n    Cx += (polygon[i].x + polygon[(i + 1) % l].x) * a;\r\n    Cy += (polygon[i].y + polygon[(i + 1) % l].y) * a;\r\n  }\r\n  signedArea *= 0.5;\r\n  let b = 1 / (6 * signedArea);\r\n  Cx *= b;\r\n  Cy *= b;\r\n  return {\r\n    x: Cx,\r\n    y: Cy,\r\n  };\r\n}\r\nfunction checkIfPolygonSelfIntersect(polygon) {\r\n  for (let i = 0, l = polygon.length; i !== l; i++) {\r\n    if (\r\n      checkCollision(\r\n        polygon[i].x,\r\n        polygon[i].y,\r\n        polygon[(i + 1) % l].x,\r\n        polygon[(i + 1) % l].y,\r\n        polygon[(i + 2) % l].x,\r\n        polygon[(i + 2) % l].y,\r\n        polygon[(i + 3) % l].x,\r\n        polygon[(i + 3) % l].y\r\n      )\r\n    ) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\nfunction getAreaOfPolygon(polygon) {\r\n  let A = 0,\r\n    sg = 1;\r\n  for (let i = 0; i !== 2; i++) {\r\n    for (let j = 0, l = polygon.length; j !== l; j++) {\r\n      A += sg * polygon[(j + i) % l].x * polygon[(j + i + sg) % l].y;\r\n    }\r\n    sg = -1;\r\n  }\r\n  A = 0.5 * Math.abs(A);\r\n  return A;\r\n}\r\nfunction addPopUp(text, x, y, frame) {\r\n  let nf = 1;\r\n  for (let i = 0; i < popUps.length; i++) {\r\n    if (!popUps[i][3]) {\r\n      popUps[i][0] = text;\r\n      popUps[i][1] = x;\r\n      popUps[i][2] = y;\r\n      popUps[i][3] = frame;\r\n      nf = 0;\r\n      break;\r\n    }\r\n  }\r\n  if (nf) popUps.push([text, x, y, frame]);\r\n}\r\nfunction handleEnemyDeathAndSplit(_enemy, inter_index) {\r\n  //#region Enemy die and split\r\n  if (_enemy.health > 0) return;\r\n  _enemy.state = 0;\r\n  addPopUp(~~_enemy.o_health, _enemy.data[0].ox, _enemy.data[0].oy, 30);\r\n  score += _enemy.o_health * scoremult;\r\n  let spawned = 0;\r\n  let t = (inter_index + 1 + ~~(_enemy.data.length / 2)) % _enemy.data.length;\r\n  let a = inter_index + 1,\r\n    b = t,\r\n    e1;\r\n  let arr = _enemy.data;\r\n  let oldCenterX = arr[0].ox,\r\n    oldCenterY = arr[0].oy;\r\n  let copy_of_b = { ...arr[b] };\r\n  if (a < b) {\r\n    e1 = arr.splice(\r\n      a,\r\n      b - a + 1,\r\n      {\r\n        ox: arr[0].ox,\r\n        oy: arr[0].oy,\r\n        x: arr[0].ox,\r\n        y: arr[0].oy,\r\n      },\r\n      copy_of_b\r\n    );\r\n  } else {\r\n    e1 = arr.splice(b, a - b, copy_of_b, {\r\n      ox: arr[0].ox,\r\n      oy: arr[0].oy,\r\n      x: arr[0].ox,\r\n      y: arr[0].oy,\r\n    });\r\n  }\r\n  e1.push({\r\n    ox: arr[0].ox,\r\n    oy: arr[0].oy,\r\n    x: arr[0].ox,\r\n    y: arr[0].oy,\r\n  });\r\n  if (e1.length > 3 && !checkIfPolygonSelfIntersect(e1)) {\r\n    let newCenter = getCentroidOfPolygon(e1);\r\n    for (let i = 0; i < e1.length; i++) {\r\n      e1[i].ox = newCenter.x;\r\n      e1[i].oy = newCenter.y;\r\n    }\r\n    let q = 1;\r\n    for (let j = 0; j < _enemy.length; j++) {\r\n      if (_enemy[j].state) continue;\r\n      _enemy[j] = new EnemyFromData(e1, {\r\n        x: _enemy.dir.x + (2 * (e1[0].ox - oldCenterX)) / _enemy.o_health,\r\n        y: _enemy.dir.y + (2 * (e1[0].oy - oldCenterY)) / _enemy.o_health,\r\n      });\r\n      if (getAreaOfPolygon(_enemy[j].data) < 1800) {\r\n        _enemy[j].state = 0;\r\n        spawned--;\r\n      }\r\n      q = 0;\r\n      break;\r\n    }\r\n    if (q) {\r\n      enemy.push(\r\n        new EnemyFromData(e1, {\r\n          x: _enemy.dir.x + (2 * (e1[0].ox - oldCenterX)) / _enemy.o_health,\r\n          y: _enemy.dir.y + (2 * (e1[0].oy - oldCenterY)) / _enemy.o_health,\r\n        })\r\n      );\r\n      if (getAreaOfPolygon(enemy[enemy.length - 1].data) < 1800) {\r\n        enemy[enemy.length - 1].state = 0;\r\n        spawned--;\r\n      }\r\n    }\r\n    spawned++;\r\n  }\r\n  let e2 = arr;\r\n  if (e2.length > 3 && !checkIfPolygonSelfIntersect(e2)) {\r\n    let newCenter = getCentroidOfPolygon(e2);\r\n    for (let i = 0; i < e2.length; i++) {\r\n      e2[i].ox = newCenter.x;\r\n      e2[i].oy = newCenter.y;\r\n    }\r\n    let q = 1;\r\n    for (let j = 0; j < _enemy.length; j++) {\r\n      if (_enemy[j].state) continue;\r\n      _enemy[j] = new EnemyFromData(e2, {\r\n        x: _enemy.dir.x + (2 * (e2[0].ox - oldCenterX)) / _enemy.o_health,\r\n        y: _enemy.dir.y + (2 * (e2[0].oy - oldCenterY)) / _enemy.o_health,\r\n      });\r\n      if (getAreaOfPolygon(_enemy[j].data) < 1800) {\r\n        _enemy[j].state = 0;\r\n        spawned--;\r\n      }\r\n      q = 0;\r\n      break;\r\n    }\r\n    if (q) {\r\n      enemy.push(\r\n        new EnemyFromData(e2, {\r\n          x: _enemy.dir.x + (2 * (e2[0].ox - oldCenterX)) / _enemy.o_health,\r\n          y: _enemy.dir.y + (2 * (e2[0].oy - oldCenterY)) / _enemy.o_health,\r\n        })\r\n      );\r\n      if (getAreaOfPolygon(enemy[enemy.length - 1].data) < 1800) {\r\n        enemy[enemy.length - 1].state = 0;\r\n        spawned--;\r\n      }\r\n    }\r\n    spawned++;\r\n  }\r\n\r\n  if (isEndless && !spawned) {\r\n    let q = 1;\r\n    for (let j = 0; j < enemy.length; j++) {\r\n      if (!enemy[j].state) {\r\n        enemy[j] = newRandomEnemy();\r\n        q = 0;\r\n        break;\r\n      }\r\n    }\r\n    if (q) enemy.push(newRandomEnemy());\r\n  }\r\n  //#endregion\r\n}\r\nfunction handleCollision_Bullet_Enemy(bullet, _enemy) {\r\n  let b_x = bullet.x,\r\n    b_y = bullet.y;\r\n  let inter_x,\r\n    inter_y,\r\n    inter_count = 0,\r\n    inter_index = 0,\r\n    n;\r\n  for (let j = 0, l = _enemy.data.length; j !== l; j++) {\r\n    let x3 = _enemy.data[j].x,\r\n      y3 = _enemy.data[j].y,\r\n      x4 = _enemy.data[(j + 1) % l].x,\r\n      y4 = _enemy.data[(j + 1) % l].y;\r\n    //#region Check how many collision\r\n    let inter = checkCollision(\r\n      b_x,\r\n      b_y,\r\n      bullet.px + _enemy.dir.x,\r\n      bullet.py + _enemy.dir.y,\r\n      x3,\r\n      y3,\r\n      x4,\r\n      y4\r\n    );\r\n    if (inter) {\r\n      inter_index = j;\r\n      inter_count++;\r\n      n = normalizeVector(y3 - y4, x4 - x3);\r\n      inter_x = inter.x;\r\n      inter_y = inter.y;\r\n    }\r\n    //#endregion\r\n  }\r\n  if (inter_count === 1) {\r\n    //#region IF HIT\r\n    let xd = bullet.dir.x,\r\n      yd = bullet.dir.y;\r\n    let t = n.x * xd + n.y * yd;\r\n    if (t >= 0) {\r\n      bullet.dir.x -= 2 * n.x * t - _enemy.dir.x;\r\n      bullet.dir.y -= 2 * n.y * t - _enemy.dir.y;\r\n    } else {\r\n      bullet.dir.x += _enemy.dir.x;\r\n      bullet.dir.y += _enemy.dir.y;\r\n    }\r\n\r\n    _enemy.dir.x +=\r\n      (_enemy.dir.x < player.max_v - 2) *\r\n      (xd - bullet.dir.x) *\r\n      (50 / _enemy.maxR ** 2);\r\n    _enemy.dir.y +=\r\n      (_enemy.dir.y < player.max_v - 2) *\r\n      (yd - bullet.dir.y) *\r\n      (50 / _enemy.maxR ** 2);\r\n    let _n = normalizeVector(bullet.dir.x, bullet.dir.y);\r\n    1;\r\n    bullet.x = inter_x + _n.x * 0.1;\r\n    bullet.y = inter_y + _n.y * 0.1;\r\n    // bullet.dir.x *= 0.9;\r\n    // bullet.dir.y *= 0.9;\r\n\r\n    _enemy.health -= bullet.damage;\r\n    score += bullet.damage * scoremult;\r\n    addPopUp(~~(bullet.damage * 10) / 10, inter_x, inter_y, 10);\r\n    bullet.damage *= Math.sqrt(\r\n      (bullet.dir.x ** 2 + bullet.dir.y ** 2) / (xd ** 2 + yd ** 2)\r\n    );\r\n    //#endregion\r\n    handleEnemyDeathAndSplit(_enemy, inter_index);\r\n  } else if (inter_count !== 0) {\r\n    bullet.state = 0;\r\n    _enemy.health -= bullet.damage;\r\n    score += bullet.damage * scoremult;\r\n    addPopUp(~~(bullet.damage * 10) / 10, inter_x, inter_y, 10);\r\n    handleEnemyDeathAndSplit(_enemy, inter_index);\r\n  }\r\n}\r\nfunction shootBullet() {\r\n  if (!bulletTimer) {\r\n    let n = 1;\r\n    for (let i = 0; i < bullet.length; i++) {\r\n      if (!bullet[i].state) {\r\n        bullet[i].reset(\r\n          player.x + (player.size / 2) * cos(angle - Math.PI / 2),\r\n          player.y + (player.size / 2) * sin(angle - Math.PI / 2),\r\n          { ...bullet_start_dir }\r\n        );\r\n        n = 0;\r\n        break;\r\n      }\r\n    }\r\n    if (n)\r\n      bullet.push(\r\n        new Bullet(\r\n          player.x + (player.size / 2) * cos(angle - Math.PI / 2),\r\n          player.y + (player.size / 2) * sin(angle - Math.PI / 2),\r\n          5,\r\n          { ...bullet_start_dir }\r\n        )\r\n      );\r\n    player.ax -= (2 * bullet_start_dir.x) / player_size; // Note: multiply with bullet damage later\r\n    player.ay -= (2 * bullet_start_dir.y) / player_size; // Note: multiply with bullet damage later\r\n    bulletTimer = o_bulletTimer;\r\n  } else {\r\n    bulletTimer--;\r\n  }\r\n}\r\nfunction burstBullet() {\r\n  let n = 0;\r\n  for (let i = 0; i < bullet.length; ++i) {\r\n    if (!bullet[i].state) {\r\n      bullet[i].reset(\r\n        player.x + (player.size / 2) * cos(angle - Math.PI / 2 + Math.random() * 2 * Math.PI - Math.PI),\r\n        player.y + (player.size / 2) * sin(angle - Math.PI / 2 + Math.random() * 2 * Math.PI - Math.PI),\r\n        { ...bullet_start_dir }\r\n      );\r\n      ++n;\r\n      player.ax -= (2 * bullet_start_dir.x) / player_size; // Note: multiply with bullet damage later\r\n      player.ay -= (2 * bullet_start_dir.y) / player_size; // Note: multiply with bullet damage later\r\n      if(n === maxBurstAmmount) break;\r\n    }\r\n  }\r\n  for (let i = n; i < maxBurstAmmount; ++i) {\r\n    bullet.push(\r\n      new Bullet(\r\n        player.x +\r\n          (player.size / 2) *\r\n            cos(angle - Math.PI / 2 + Math.random() * 2 * Math.PI - Math.PI),\r\n        player.y +\r\n          (player.size / 2) *\r\n            sin(angle - Math.PI / 2 + Math.random() * 2 * Math.PI - Math.PI),\r\n        5,\r\n        { ...bullet_start_dir }\r\n      )\r\n    );\r\n    player.ax -= (2 * bullet_start_dir.x) / player_size; // Note: multiply with bullet damage later\r\n    player.ay -= (2 * bullet_start_dir.y) / player_size; // Note: multiply with bullet damage later\r\n  }\r\n  \r\n}\r\n//#endregion\r\n\r\n//#region Creating Enemy\r\nfunction Enemy(\r\n  o_x,\r\n  o_y,\r\n  min_v = 5,\r\n  max_v = 10,\r\n  min_r = 20,\r\n  max_r = 40,\r\n  _dir = { _x: 0, _y: 0 }\r\n) {\r\n  let nVertices = min_v + ~~(Math.random() * (max_v - min_v));\r\n  let _a = (2 * Math.PI) / nVertices;\r\n  let EnemyPositionData = [];\r\n  let _maxR = 0;\r\n  for (let i = 0; i < nVertices; i++) {\r\n    let _r = min_r + ModifiedRandomAboveAvg() * (max_r - min_r);\r\n    if (_r > _maxR) _maxR = _r;\r\n    EnemyPositionData.push({\r\n      ox: o_x,\r\n      oy: o_y,\r\n      x: o_x + _r * cos(i * _a),\r\n      y: o_y + _r * sin(i * _a),\r\n    });\r\n  }\r\n  let newCenter = getCentroidOfPolygon(EnemyPositionData);\r\n  for (let i = 0; i < EnemyPositionData.length; i++) {\r\n    EnemyPositionData[i].ox = newCenter.x;\r\n    EnemyPositionData[i].oy = newCenter.y;\r\n  }\r\n  let _health = ~~(getAreaOfPolygon(EnemyPositionData) / 300);\r\n  return {\r\n    data: EnemyPositionData,\r\n    dir: {\r\n      x: _dir._x,\r\n      y: _dir._y,\r\n    },\r\n    maxR: _maxR,\r\n    health: _health,\r\n    o_health: _health,\r\n    state: 1,\r\n  };\r\n}\r\nfunction EnemyFromData(positon_data, _dir = { x: 2, y: 0 }) {\r\n  let _enemy = {\r\n    data: positon_data,\r\n    dir: _dir,\r\n    state: 1,\r\n  };\r\n  let a = getMaxMinCo_Enemy(_enemy);\r\n  _enemy.top = a.yMin + _enemy.data[0].oy;\r\n  _enemy.bottom = a.yMax + _enemy.data[0].oy;\r\n  _enemy.right = a.xMax + _enemy.data[0].ox;\r\n  _enemy.left = a.xMin + _enemy.data[0].ox;\r\n  _enemy.maxR = Math.sqrt(\r\n    ((a.xMax - a.xMin) / 2) ** 2 + ((a.yMax - a.yMin) / 2) ** 2\r\n  );\r\n  let _health = ~~(getAreaOfPolygon(positon_data) / 300);\r\n  _enemy.health = _health;\r\n  _enemy.o_health = _health;\r\n  return _enemy;\r\n}\r\nfunction newRandomEnemy() {\r\n  let _r = minR + ModifiedRandomBelowAvg() * (maxR - minR);\r\n  let e = new Enemy(\r\n    maxR + Math.random() * (c_width - maxR),\r\n    -(maxMapHeight - startMapLevel * c_height) + maxMapHeight * Math.random(),\r\n    minVertices,\r\n    maxVertices,\r\n    _r / 4,\r\n    _r,\r\n    {\r\n      _x: -6 + Math.random() * 12,\r\n      _y: -6 + Math.random() * 12,\r\n    }\r\n  );\r\n  let a = getMaxMinCo_Enemy(e);\r\n  e.top = a.yMin + e.data[0].oy;\r\n  e.bottom = a.yMax + e.data[0].oy;\r\n  e.right = a.xMax + e.data[0].ox;\r\n  e.left = a.xMin + e.data[0].ox;\r\n  return e;\r\n}\r\n//#endregion\r\n\r\n//#region Creating Player\r\nfunction createPlayer() {\r\n  return {\r\n    px: org_player_x,\r\n    py: org_player_y,\r\n    x: org_player_x,\r\n    y: org_player_y,\r\n    ax: 0,\r\n    vx: 0,\r\n    ay: 0,\r\n    vy: 0,\r\n    max_v: 8,\r\n    size: player_size,\r\n    update: function () {\r\n      this.vx += this.ax * (Math.abs(this.vx) <= this.max_v);\r\n      this.x +=\r\n        this.vx *\r\n        ((this.x > org_x || this.vx > 0) &&\r\n          (this.x < org_x + c_width || this.vx < 0));\r\n      this.vy += this.ay * (Math.abs(this.vy) <= this.max_v);\r\n      this.y += this.vy;\r\n\r\n      this.ax = 0;\r\n      this.ay = 0;\r\n      this.vx *= 0.8;\r\n      this.vy *= 0.8;\r\n    },\r\n    img: (() => {\r\n      let can = document.createElement(\"canvas\");\r\n      let _c = can.getContext(\"2d\");\r\n      can.width = player_size;\r\n      can.height = player_size;\r\n      _c.fillStyle = \"#ffffff\";\r\n      _c.strokeStyle = \"#ffffff\";\r\n      _c.beginPath();\r\n      _c.moveTo(can.width / 2, 0);\r\n      _c.lineTo(can.width, can.height);\r\n      _c.lineTo(can.width / 2, can.height / 2);\r\n      _c.lineTo(0, can.height);\r\n      _c.closePath();\r\n      _c.stroke();\r\n      _c.fill();\r\n      return can;\r\n    })(),\r\n  };\r\n}\r\nfunction resetPlayer() {\r\n  let px = player.x;\r\n  let py = player.y;\r\n\r\n  player = createPlayer();\r\n  player.px = px;\r\n  player.py = py;\r\n}\r\n//#endregion\r\n\r\n//#endregion\r\n\r\n//#region Update and Drawing Functions\r\nfunction drawEnemy(_enemy) {\r\n  c.beginPath();\r\n  c.moveTo(_enemy.data[0].x, _enemy.data[0].y);\r\n  for (let i = 1; i < _enemy.data.length; i++) {\r\n    c.lineTo(_enemy.data[i].x, _enemy.data[i].y);\r\n  }\r\n  c.closePath();\r\n  c.stroke();\r\n  // c.fill();\r\n}\r\nfunction updateEnemy(_enemy) {\r\n  let a = _enemy.dir.x,\r\n    b = _enemy.dir.y;\r\n  for (let i = 0; i < _enemy.data.length; i++) {\r\n    _enemy.data[i].x += a;\r\n    _enemy.data[i].y += b;\r\n    _enemy.data[i].ox += a;\r\n    _enemy.data[i].oy += b;\r\n  }\r\n  _enemy.right += a;\r\n  _enemy.top += b;\r\n  _enemy.left += a;\r\n  _enemy.bottom += b;\r\n  _enemy.dir.x *= 0.9999;\r\n  _enemy.dir.y *= 0.9999;\r\n}\r\nfunction drawPlayer(_player) {\r\n  c.save();\r\n  c.translate(_player.x, _player.y);\r\n  c.rotate(angle);\r\n  c.drawImage(_player.img, -_player.size / 2, -_player.size / 2);\r\n  c.restore();\r\n}\r\nfunction drawBullet(_bullet) {\r\n  c.drawImage(_bullet.img, _bullet.x - _bullet.r, _bullet.y - _bullet.r);\r\n}\r\nfunction drawHealthBar(_enemy) {\r\n  let mid = (_enemy.left + _enemy.right) / 2;\r\n  c.strokeRect(mid - 50, _enemy.bottom + 10, 100, 10);\r\n  c.fillRect(\r\n    mid - 50,\r\n    _enemy.bottom + 10,\r\n    (_enemy.health / _enemy.o_health) * 100,\r\n    10\r\n  );\r\n}\r\n//#endregion\r\n\r\n//#region Event Handling\r\ncanvas.addEventListener(\"mousemove\", (event) => {\r\n  p_angle = angle;\r\n  angle =\r\n    atan2(event.clientY + org_y - player.y, event.clientX + org_x - player.x) +\r\n    Math.PI / 2;\r\n  bullet_start_dir.x = Bullet.bulletSpeed * sin(angle);\r\n  bullet_start_dir.y = -Bullet.bulletSpeed * cos(angle);\r\n  // console.log(angle * 180 / Math.PI);\r\n});\r\nlet playerAccel = 2;\r\ndocument.addEventListener(\"keydown\", (event) => {\r\n  keyPressedPool.add(event.code);\r\n});\r\ndocument.addEventListener(\"keyup\", (event) => {\r\n  keyPressedPool.delete(event.code);\r\n});\r\ndocument.addEventListener(\"mousedown\", (event) => {\r\n  if (event.button === 0) keyPressedPool.add(\"LeftMouse\");\r\n});\r\ndocument.addEventListener(\"mouseup\", (event) => {\r\n  if (event.button === 0) keyPressedPool.delete(\"LeftMouse\");\r\n});\r\ndocument.addEventListener(\"visibilitychange\", () => {\r\n  keyPressedPool.clear();\r\n});\r\ndocument.oncontextmenu = () => false;\r\nwindow.addEventListener(\"resize\", () => {\r\n  if (window.innerHeight !== c_height) {\r\n    location.reload();\r\n  }\r\n});\r\n\r\n//#endregion\r\n\r\n//#region Set up\r\nfunction setup() {\r\n  score = 0;\r\n  enemy = [\r\n    (() => {\r\n      let _r = minR + ModifiedRandomBelowAvg() * (maxR - minR);\r\n      let e = Enemy(\r\n        c_width / 2,\r\n        c_height / 5,\r\n        minVertices,\r\n        maxVertices,\r\n        _r / 4,\r\n        _r,\r\n        {\r\n          _x: -1 + Math.random() * 2,\r\n          _y: -1 + Math.random() * 2,\r\n        }\r\n      );\r\n      let a = getMaxMinCo_Enemy(e);\r\n      e.top = a.yMin + e.data[0].oy;\r\n      e.bottom = a.yMax + e.data[0].oy;\r\n      e.right = a.xMax + e.data[0].ox;\r\n      e.left = a.xMin + e.data[0].ox;\r\n      return e;\r\n    })(),\r\n  ];\r\n  for (let i = 1; i < n_enemy; i++) {\r\n    enemy.push(newRandomEnemy());\r\n  }\r\n  player = createPlayer();\r\n}\r\nsetup();\r\n//#endregion\r\n\r\n//#region Main Loop\r\n// _________________MAIN_LOOP_________________\r\nfunction draw() {\r\n  player.py = player.y;\r\n  player.px = player.x;\r\n\r\n  player.update();\r\n  c.clearRect(org_x, org_y, c_width, c_height);\r\n\r\n  for (let i = 0; i < enemy.length; i++) {\r\n    if (enemy[i].state) {\r\n      updateEnemy(enemy[i]);\r\n      if (enemy[i].bottom > org_y - 10 && enemy[i].top < org_y + c_height + 10)\r\n        enemyInView.add(i);\r\n      else enemyInView.delete(i);\r\n    } else enemyInView.delete(i);\r\n  }\r\n  //#region Draw Stuffs\r\n  for (let i of enemyInView) {\r\n    drawEnemy(enemy[i]);\r\n  }\r\n  drawPlayer(player);\r\n  c.fillText(`Score(x${scoremult}):${~~score}`, org_x + 10, org_y + 32);\r\n  for (let i = 0; i < popUps.length; i++) {\r\n    if (popUps[i][3] !== 0) {\r\n      c.fillText(popUps[i][0], popUps[i][1], popUps[i][2]);\r\n      popUps[i][3]--;\r\n      popUps[i][2] -= 7;\r\n    }\r\n  }\r\n  for (let i in enemiesToShowHealth) {\r\n    if (enemiesToShowHealth[i] === 0 || !enemy[i].state) {\r\n      delete enemiesToShowHealth[i];\r\n      continue;\r\n    }\r\n    drawHealthBar(enemy[i]);\r\n    enemiesToShowHealth[i]--;\r\n  }\r\n  //#endregion\r\n\r\n  //#region Enemy Wrap Around\r\n  for (let i = 0; i !== enemy.length; i++) {\r\n    let left = enemy[i].left;\r\n    let right = enemy[i].right;\r\n    let top = enemy[i].top;\r\n    let bottom = enemy[i].bottom;\r\n    if (left > org_x + c_width) {\r\n      let a = right - org_x;\r\n      enemy[i].left -= a;\r\n      enemy[i].right -= a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].x -= a;\r\n        enemy[i].data[j].ox -= a;\r\n      }\r\n    } else if (right < org_x) {\r\n      let a = c_width + org_x - left;\r\n      enemy[i].left += a;\r\n      enemy[i].right += a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].x += a;\r\n        enemy[i].data[j].ox += a;\r\n      }\r\n    }\r\n    if (bottom < -maxMapHeight) {\r\n      let a = c_height - top;\r\n      enemy[i].top += a;\r\n      enemy[i].bottom += a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].y += a;\r\n        enemy[i].data[j].oy += a;\r\n      }\r\n    } else if (top > c_height) {\r\n      let a = maxMapHeight + bottom;\r\n      enemy[i].top -= a;\r\n      enemy[i].bottom -= a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].y -= a;\r\n        enemy[i].data[j].oy -= a;\r\n      }\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Draw bullets & Collision detection between bullets & others\r\n  for (let i = 0; i < bullet.length; i++) {\r\n    if (bullet[i].state) {\r\n      drawBullet(bullet[i]);\r\n      bullet[i].px = bullet[i].x;\r\n      bullet[i].py = bullet[i].y;\r\n      bullet[i].update();\r\n\r\n      let b_x = bullet[i].x,\r\n        b_y = bullet[i].y;\r\n      //#region Player Collision Detection\r\n      if (isHardMode) {\r\n        let squareDist = (player.x - b_x) ** 2 + (player.y - b_y) ** 2;\r\n        if (squareDist <= (player.size / 3 + bullet[i].r) ** 2) {\r\n          resetPlayer(player);\r\n        }\r\n      }\r\n      //#endregion\r\n\r\n      //#region Enemy Collsion Detection\r\n      for (let m of enemyInView) {\r\n        if (!enemy[m].state) continue;\r\n        if (\r\n          !(\r\n            b_x > enemy[m].left - 10 &&\r\n            b_x < enemy[m].right + 10 &&\r\n            b_y < enemy[m].bottom + 10 &&\r\n            b_y > enemy[m].top - 10\r\n          )\r\n        )\r\n          continue;\r\n        enemiesToShowHealth[m] = 10;\r\n        handleCollision_Bullet_Enemy(bullet[i], enemy[m]);\r\n      }\r\n      //#endregion\r\n\r\n      if (\r\n        b_y < org_y - bullet[i].r ||\r\n        b_y > org_y + c_height ||\r\n        b_x < org_x ||\r\n        b_x > org_x + c_width ||\r\n        Math.sqrt(bullet[i].dir.x ** 2 + bullet[i].dir.y ** 2) < 0.65\r\n      ) {\r\n        bullet[i].state = 0;\r\n        continue;\r\n      }\r\n      // drawBullet(bullet[i]);\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Player collision with enemies\r\n  for (let m = 0, __l = enemy.length; m !== __l; m++) {\r\n    if (!enemy[m].state) continue;\r\n    let player_x = player.x,\r\n      player_y = player.y;\r\n    if (\r\n      player_x > enemy[m].left - 10 &&\r\n      player_x < enemy[m].right + 10 &&\r\n      player_y < enemy[m].bottom + 10 &&\r\n      player_y > enemy[m].top - 10\r\n    ) {\r\n      for (let j = 0, l = enemy[m].data.length; j !== l; j++) {\r\n        let x3 = enemy[m].data[j].x,\r\n          y3 = enemy[m].data[j].y,\r\n          x4 = enemy[m].data[(j + 1) % l].x,\r\n          y4 = enemy[m].data[(j + 1) % l].y;\r\n        if (\r\n          checkCollision(\r\n            player_x,\r\n            player_y,\r\n            player.px + enemy[m].dir.x,\r\n            player.py + enemy[m].dir.y,\r\n            x3,\r\n            y3,\r\n            x4,\r\n            y4\r\n          )\r\n        ) {\r\n          resetPlayer(player);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Camera moves with player\r\n  if (player.py !== player.y || player.px !== player.x) {\r\n    translate_x = (player.px - player.x) * 0.1;\r\n    translate_y = player.py - player.y;\r\n    org_x -= translate_x;\r\n    if (player.y >= org_player_y) translate_y = org_y;\r\n    else if (player.y <= -maxMapHeight + org_player_y)\r\n      translate_y = org_y + maxMapHeight;\r\n\r\n    org_y -= translate_y;\r\n    c.translate(translate_x, translate_y);\r\n  }\r\n  //#endregion\r\n\r\n  //#region Input check\r\n  if (keyPressedPool.size) {\r\n    if (controlKey.focus.some((x) => keyPressedPool.has(x))) {\r\n      player.max_v = 4;\r\n      o_bulletTimer = 2;\r\n    } else {\r\n      player.max_v = 8;\r\n      o_bulletTimer = 4;\r\n    }\r\n\r\n    if (controlKey.up.some((x) => keyPressedPool.has(x)))\r\n      player.ay = -playerAccel;\r\n    if (controlKey.down.some((x) => keyPressedPool.has(x)))\r\n      player.ay = playerAccel;\r\n    if (controlKey.left.some((x) => keyPressedPool.has(x))) {\r\n      player.ax = -playerAccel;\r\n    }\r\n    if (controlKey.right.some((x) => keyPressedPool.has(x)))\r\n      player.ax = playerAccel;\r\n    if (controlKey.shoot.some((x) => keyPressedPool.has(x))) {\r\n      burstBullet();\r\n    }\r\n  }\r\n  //#endregion\r\n  requestAnimationFrame(draw);\r\n}\r\ndraw();\r\n//#endregion\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}