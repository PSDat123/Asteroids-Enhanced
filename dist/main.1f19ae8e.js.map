{"version":3,"sources":["main.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["controlKey","up","down","left","right","shoot","focus","canvas","document","getElementById","c","getContext","c_width","window","screen","width","c_height","innerHeight","height","style","background","lineWidth","strokeStyle","fillStyle","font","maxR","minR","minVertices","maxVertices","maxMapHeight","startMapLevel","n_enemy","bullet","keyPressedPool","Set","p_angle","angle","translate_x","translate_y","o_bulletTimer","bulletTimer","org_x","org_y","org_player_x","org_player_y","player_size","player","enemy","score","rounded_score","scoremult","popUps","isEndless","isHardMode","Bullet","x","y","r","_dir","bulletSpeed","px","py","img","can","createElement","_c","beginPath","arc","Math","PI","fill","dir","state","damage","speed","bullet_start_dir","ModifiedRandomAboveAvg","random","ModifiedRandomBelowAvg","getMaxMinCo_Enemy","_enemy","x_arr","data","map","a","ox","x_max","max","x_min","min","y_arr","b","oy","y_max","y_min","xMax","xMin","yMax","yMin","normalizeVector","_x","_y","mag","sqrt","checkCollision","x1","y1","x2","y2","x3","y3","x4","y4","dem","uA","uB","checkCollision_Bullet_Enemy","_bullet","xC","yC","minIndex","minDistSq","xM","yM","_nx","_ny","i","l","length","xA","yA","xB","yB","_an","_bn","_xM","_yM","distSq","n","IM","dotP","m","normal","index","getCentroidOfPolygon","polygon","signedArea","Cx","Cy","checkIfPolygonSelfIntersect","getAreaOfPolygon","A","sg","j","abs","addPopUp","text","frame","nf","push","Enemy","o_x","o_y","min_v","max_v","min_r","max_r","nVertices","_a","EnemyPositionData","_maxR","_r","cos","sin","newCenter","health","o_health","EnemyFromData","positon_data","top","bottom","newEnemy","e","createPlayer","ax","vx","ay","vy","size","update","moveTo","lineTo","closePath","stroke","resetPlayer","drawEnemy","updateEnemy","drawPlayer","_player","save","translate","rotate","drawImage","restore","drawBullet","addEventListener","event","atan2","clientY","clientX","playerAccel","add","code","delete","includes","button","clear","oncontextmenu","location","reload","setup","draw","clearRect","fillText","b_x","b_y","squareDist","__l","inter_x","inter_y","inter_count","inter_index","inter","xd","yd","t","_n","spawned","e1","arr","oldCenterX","oldCenterY","copy_of_b","splice","v","q","z","e2","player_x","player_y","filter","has","reset","requestAnimationFrame","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","protocol","ws","onmessage","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","hmrApply","hmrAcceptRun","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","body","appendChild","remove","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"main.1f19ae8e.js","sourceRoot":"..\\src","sourcesContent":["\"use strict\";\r\nlet controlKey = {\r\n  up: [\"ArrowUp\", \"KeyW\"],\r\n  down: [\"ArrowDown\", \"KeyS\"],\r\n  left: [\"ArrowLeft\", \"KeyA\"],\r\n  right: [\"ArrowRight\", \"KeyD\"],\r\n  shoot: [\"KeyZ\", \"LeftMouse\"],\r\n  focus: [\"ShiftLeft\"],\r\n};\r\n\r\n//#region Global varibles\r\nlet canvas = document.getElementById(\"main-canvas\");\r\nlet c = canvas.getContext(\"2d\");\r\n\r\nlet c_width = window.screen.width;\r\nlet c_height = window.innerHeight;\r\ncanvas.width = c_width;\r\ncanvas.height = c_height;\r\ncanvas.style.background = \"#000000\";\r\nc.lineWidth = 3;\r\nc.strokeStyle = \"#ffffff\";\r\nc.fillStyle = \"#ffffff\";\r\nc.font = \"22px pressStart\";\r\n\r\nlet maxR = 400, //Maximun size of asteroid\r\n  minR = 40, //Minimun size of asteroid\r\n  minVertices = 7,\r\n  maxVertices = 25,\r\n  maxMapHeight = 7 * c_height, //Maximun scroll height\r\n  startMapLevel = 0, // Map's portion to start at\r\n  n_enemy = 15, // Number of enemy\r\n  bullet = [], // Array containing all bullet object\r\n  keyPressedPool = new Set(), // Set containing user's inputs\r\n  p_angle = 0, // Previous angle of player (Pointing to mouse)\r\n  angle = 0, // Angle of player (Pointing to mouse)\r\n  translate_x = 0, // Amount x to translate when player moves (Camera Follow)\r\n  translate_y = 0, // Amount y to translate when player moves (Camera Follow)\r\n  o_bulletTimer = 4, // Number of iteration before shooting bullet (bullet per 4 frames)\r\n  bulletTimer = 0, // Count ^\r\n  org_x = 0, // x of top left corner\r\n  org_y = 0, // y of top left corner\r\n  org_player_x = c_width / 2,\r\n  org_player_y = c_height / 1.5,\r\n  player_size = 30,\r\n  player,\r\n  enemy = [],\r\n  score = 0,\r\n  rounded_score = 0,\r\n  scoremult = 1,\r\n  popUps = [];\r\n\r\nlet isEndless = 0,\r\n  isHardMode = 0;\r\n//#endregion\r\n\r\n//#region Setup Functions\r\n\r\n//#region Classes\r\nclass Bullet {\r\n  static bulletSpeed = 14;\r\n  constructor(x, y, r, _dir = { x: 0, y: -Bullet.bulletSpeed }) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.px = x;\r\n    this.py = y;\r\n    this.r = r;\r\n    this.img = (() => {\r\n      let can = document.createElement(\"canvas\");\r\n      let _c = can.getContext(\"2d\");\r\n      can.width = r * 2;\r\n      can.height = r * 2;\r\n      _c.fillStyle = \"#ffffff\";\r\n      _c.beginPath();\r\n      _c.arc(r, r, r, 0, 2 * Math.PI);\r\n      _c.fill();\r\n      return can;\r\n    })();\r\n    this.dir = _dir;\r\n    this.state = 1;\r\n    this.damage = 1;\r\n  }\r\n  update() {\r\n    this.x += this.dir.x;\r\n    this.y += this.dir.y;\r\n  }\r\n  reset(x, y, _dir = { x: 0, y: -Bullet.speed }) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.px = x;\r\n    this.py = y;\r\n    this.dir = _dir;\r\n    this.state = 1;\r\n    this.damage = 1;\r\n  }\r\n}\r\nlet bullet_start_dir = { x: 0, y: -Bullet.bulletSpeed }; // Starting position of bullet\r\n//#endregion\r\n\r\n//#region Misc Fucntions\r\nfunction ModifiedRandomAboveAvg() {\r\n  let x = Math.random();\r\n  return 4.5 * x ** 3 - 8.3 * x ** 2 + 4.8 * x;\r\n}\r\nfunction ModifiedRandomBelowAvg() {\r\n  let x = Math.random();\r\n  return 2.2 * x ** 3 - 3 * x ** 2 + 1.8 * x;\r\n}\r\nfunction getMaxMinCo_Enemy(_enemy) {\r\n  let x_arr = _enemy.data.map((a) => a.x - a.ox);\r\n  let x_max = Math.max(...x_arr),\r\n    x_min = Math.min(...x_arr);\r\n  let y_arr = _enemy.data.map((b) => b.y - b.oy);\r\n  let y_max = Math.max(...y_arr),\r\n    y_min = Math.min(...y_arr);\r\n\r\n  return {\r\n    xMax: x_max,\r\n    xMin: x_min,\r\n    yMax: y_max,\r\n    yMin: y_min,\r\n  };\r\n}\r\nfunction normalizeVector(_x, _y) {\r\n  let mag = Math.sqrt(_x ** 2 + _y ** 2);\r\n  return {\r\n    x: _x / mag,\r\n    y: _y / mag,\r\n  };\r\n}\r\nfunction checkCollision(x1, y1, x2, y2, x3, y3, x4, y4) {\r\n  let dem = (y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1);\r\n  let uA = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / dem;\r\n  let uB = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / dem;\r\n  if (uA >= 0 && uA <= 1 && uB >= 0 && uB <= 1) {\r\n    return {\r\n      x: x1 + uA * (x2 - x1),\r\n      y: y1 + uA * (y2 - y1),\r\n    };\r\n  }\r\n  return false;\r\n}\r\nfunction checkCollision_Bullet_Enemy(_bullet, _enemy) {\r\n  let xC = _bullet.x, yC = _bullet.y;\r\n  let minIndex = -1, minDistSq = 0, xM = 0, yM = 0, _nx = 0, _ny = 0;\r\n  for (let i = 0, l = _enemy.data.length; i !== l; i++) {\r\n    let xA = _enemy.data[i].x,\r\n      yA = _enemy.data[i].y,\r\n      xB = _enemy.data[(i + 1) % l].x,\r\n      yB = _enemy.data[(i + 1) % l].y;\r\n    let _an = yA - yB,  _bn = xB - xA,\r\n     a = -_an / _bn, b = (_an/_bn) * xA + yA,\r\n     _xM = (xC + a * yC - a * b) / (1 + a * a),\r\n     _yM = (a * a * yC + a*xC+b) / (1 + a * a);\r\n    let distSq = (_xM - xC) * (_xM - xC) + (_yM - yC) * (_yM - yC);\r\n    // c.beginPath();\r\n    // c.arc(_xM, _yM, 10, 0, 2*Math.PI);\r\n    // c.stroke();\r\n    if ((_xM < xA && _xM > xB) || (_xM > xA && _xM < xB)){\r\n      if (minIndex === -1) {\r\n        minIndex = i;\r\n        minDistSq = distSq;\r\n        (xM = _xM), (yM = _yM);\r\n        (_nx = yA - yB), (_ny = xB - xA);\r\n      } else if (distSq < minDistSq) {\r\n        minIndex = i;\r\n        minDistSq = distSq;\r\n        (xM = _xM), (yM = _yM);\r\n        (_nx = _an), (_ny = _bn);\r\n      }\r\n    }\r\n  }\r\n  let n = normalizeVector(_nx, _ny), IM = {\r\n    x: xM - xC,\r\n    y: yM - yC,\r\n  }\r\n  let dotP = IM.x * n.x + IM.y * n.y, m = 0;\r\n  if(minDistSq < _bullet.r * _bullet.r){\r\n    m = _bullet.r - Math.sqrt(minDistSq);\r\n    return {\r\n      x: xC - m * n.x,\r\n      y: yC - m * n.y,\r\n      normal: n,\r\n      index: minIndex,\r\n    };\r\n  }\r\n  return false\r\n}\r\nfunction getCentroidOfPolygon(polygon) {\r\n  let signedArea = 0,\r\n    Cx = 0,\r\n    Cy = 0;\r\n  for (let i = 0, l = polygon.length; i !== l; i++) {\r\n    let a =\r\n      polygon[i].x * polygon[(i + 1) % l].y -\r\n      polygon[(i + 1) % l].x * polygon[i].y;\r\n    signedArea += a;\r\n    Cx += (polygon[i].x + polygon[(i + 1) % l].x) * a;\r\n    Cy += (polygon[i].y + polygon[(i + 1) % l].y) * a;\r\n  }\r\n  signedArea *= 0.5;\r\n  let b = 1 / (6 * signedArea);\r\n  Cx *= b;\r\n  Cy *= b;\r\n  return {\r\n    x: Cx,\r\n    y: Cy,\r\n  };\r\n}\r\nfunction checkIfPolygonSelfIntersect(polygon) {\r\n  for (let i = 0, l = polygon.length; i !== l; i++) {\r\n    if (\r\n      checkCollision(\r\n        polygon[i].x,\r\n        polygon[i].y,\r\n        polygon[(i + 1) % l].x,\r\n        polygon[(i + 1) % l].y,\r\n        polygon[(i + 2) % l].x,\r\n        polygon[(i + 2) % l].y,\r\n        polygon[(i + 3) % l].x,\r\n        polygon[(i + 3) % l].y\r\n      )\r\n    ) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\nfunction getAreaOfPolygon(polygon) {\r\n  let A = 0, sg = 1;\r\n  for(let i = 0; i !== 2; i++){\r\n    for(let j = 0, l = polygon.length; j !== l; j++){\r\n      A += sg * polygon[(j + i) % l].x * polygon[(j + i + sg) % l].y;\r\n    }\r\n    sg = -1;\r\n  }\r\n  A = 0.5 * Math.abs(A);\r\n  return A;\r\n}\r\nfunction addPopUp(text, x, y, frame){\r\n  let nf = 1;\r\n  for(let i = 0; i < popUps.length; i++){\r\n    if(!popUps[i][3]){\r\n      popUps[i][0] = text;\r\n      popUps[i][1] = x;\r\n      popUps[i][2] = y;\r\n      popUps[i][3] = frame;\r\n      nf = 0\r\n      break;\r\n    }\r\n  }\r\n  if(nf) popUps.push([text, x, y, frame]);\r\n}\r\n//#endregion\r\n\r\n//#region Creating Enemy\r\nfunction Enemy(\r\n  o_x,\r\n  o_y,\r\n  min_v = 5,\r\n  max_v = 10,\r\n  min_r = 20,\r\n  max_r = 40,\r\n  _dir = { _x: 0, _y: 0 }\r\n) {\r\n  let nVertices = min_v + ~~(Math.random() * (max_v - min_v));\r\n  let _a = (2 * Math.PI) / nVertices;\r\n  let EnemyPositionData = [];\r\n  let _maxR = 0;\r\n  for (let i = 0; i < nVertices; i++) {\r\n    let _r = min_r + Math.random() * (max_r - min_r);\r\n    if (_r > _maxR) _maxR = _r;\r\n    EnemyPositionData.push({\r\n      ox: o_x,\r\n      oy: o_y,\r\n      x: o_x + _r * Math.cos(i * _a),\r\n      y: o_y + _r * Math.sin(i * _a),\r\n    });\r\n  }\r\n  let newCenter = getCentroidOfPolygon(EnemyPositionData);\r\n  for (let i = 0; i < EnemyPositionData.length; i++) {\r\n    EnemyPositionData[i].ox = newCenter.x;\r\n    EnemyPositionData[i].oy = newCenter.y;\r\n  }\r\n  return {\r\n    data: EnemyPositionData,\r\n    dir: {\r\n      x: _dir._x,\r\n      y: _dir._y,\r\n    },\r\n    maxR: _maxR,\r\n    health: ~~(_maxR / 3), \r\n    o_health: ~~(_maxR / 3),\r\n    state: 1,\r\n  };\r\n}\r\nfunction EnemyFromData(positon_data, _dir = { x: 2, y: 0 }) {\r\n  let _enemy = {\r\n    data: positon_data,\r\n    dir: _dir,\r\n    state: 1,\r\n  };\r\n  let a = getMaxMinCo_Enemy(_enemy);\r\n  _enemy.top = a.yMin + _enemy.data[0].oy;\r\n  _enemy.bottom = a.yMax + _enemy.data[0].oy;\r\n  _enemy.right = a.xMax + _enemy.data[0].ox;\r\n  _enemy.left = a.xMin + _enemy.data[0].ox;\r\n  _enemy.maxR = Math.sqrt(\r\n    ((a.xMax - a.xMin) / 2) ** 2 + ((a.yMax - a.yMin) / 2) ** 2\r\n  );\r\n  _enemy.health = ~~(_enemy.maxR / 3);\r\n  _enemy.o_health = ~~(_enemy.maxR / 3);\r\n  return _enemy;\r\n}\r\nfunction newEnemy() {\r\n  let _r = minR + ModifiedRandomBelowAvg() * (maxR - minR);\r\n  let e = new Enemy(\r\n    maxR + Math.random() * (c_width - maxR),\r\n    -(maxMapHeight - startMapLevel * c_height) + maxMapHeight * Math.random(),\r\n    minVertices,\r\n    maxVertices,\r\n    _r / 4,\r\n    _r,\r\n    {\r\n      _x: -6 + Math.random() * 12,\r\n      _y: -6 + Math.random() * 12,\r\n    }\r\n  );\r\n  let a = getMaxMinCo_Enemy(e);\r\n  e.top = a.yMin + e.data[0].oy;\r\n  e.bottom = a.yMax + e.data[0].oy;\r\n  e.right = a.xMax + e.data[0].ox;\r\n  e.left = a.xMin + e.data[0].ox;\r\n  return e;\r\n}\r\n//#endregion\r\n\r\n//#region Creating Player\r\nfunction createPlayer() {\r\n  return {\r\n    px: org_player_x,\r\n    py: org_player_y,\r\n    x: org_player_x,\r\n    y: org_player_y,\r\n    ax: 0,\r\n    vx: 0,\r\n    ay: 0,\r\n    vy: 0,\r\n    max_v: 8,\r\n    size: player_size,\r\n    update: function () {\r\n      this.vx += this.ax * (Math.abs(this.vx) <= this.max_v);\r\n      this.x +=\r\n        this.vx *\r\n        ((this.x > org_x || this.vx > 0) &&\r\n          (this.x < org_x + c_width || this.vx < 0));\r\n      this.vy += this.ay * (Math.abs(this.vy) <= this.max_v);\r\n      this.y += this.vy;\r\n\r\n      this.vx *= 0.8;\r\n      this.vy *= 0.8;\r\n    },\r\n    img: (() => {\r\n      let can = document.createElement(\"canvas\");\r\n      let _c = can.getContext(\"2d\");\r\n      can.width = player_size;\r\n      can.height = player_size;\r\n      _c.fillStyle = \"#ffffff\";\r\n      _c.strokeStyle = \"#ffffff\";\r\n      _c.beginPath();\r\n      _c.moveTo(can.width / 2, 0);\r\n      _c.lineTo(can.width, can.height);\r\n      _c.lineTo(can.width / 2, can.height / 2);\r\n      _c.lineTo(0, can.height);\r\n      _c.closePath();\r\n      _c.stroke();\r\n      _c.fill();\r\n      return can;\r\n    })(),\r\n  };\r\n}\r\nfunction resetPlayer() {\r\n  let px = player.x;\r\n  let py = player.y;\r\n\r\n  player = createPlayer();\r\n  player.px = px;\r\n  player.py = py;\r\n}\r\n//#endregion\r\n//#endregion\r\n\r\n//#region Update and Drawing Functions\r\nfunction drawEnemy(_enemy) {\r\n  c.beginPath();\r\n  c.moveTo(_enemy.data[0].x, _enemy.data[0].y);\r\n  for (let i = 1; i < _enemy.data.length; i++) {\r\n    c.lineTo(_enemy.data[i].x, _enemy.data[i].y);\r\n  }\r\n  c.closePath();\r\n  c.stroke();\r\n  // c.fill();\r\n}\r\nfunction updateEnemy(_enemy) {\r\n  let a = _enemy.dir.x,\r\n    b = _enemy.dir.y;\r\n  for (let i = 0; i < _enemy.data.length; i++) {\r\n    _enemy.data[i].x += a;\r\n    _enemy.data[i].y += b;\r\n    _enemy.data[i].ox += a;\r\n    _enemy.data[i].oy += b;\r\n  }\r\n  _enemy.right += a;\r\n  _enemy.top += b;\r\n  _enemy.left += a;\r\n  _enemy.bottom += b;\r\n  _enemy.dir.x *= 0.9999;\r\n  _enemy.dir.y *= 0.9999;\r\n}\r\nfunction drawPlayer(_player) {\r\n  c.save();\r\n  c.translate(_player.x, _player.y);\r\n  c.rotate(angle);\r\n  c.drawImage(_player.img, -_player.size / 2, -_player.size / 2);\r\n  c.restore();\r\n}\r\nfunction drawBullet(_bullet) {\r\n  c.drawImage(_bullet.img, _bullet.x - _bullet.r, _bullet.y - _bullet.r);\r\n}\r\n//#endregion\r\n\r\n//#region Event Handling\r\n\r\ncanvas.addEventListener(\"mousemove\", (event) => {\r\n  p_angle = angle;\r\n  angle =\r\n    Math.atan2(\r\n      event.clientY + org_y - player.y,\r\n      event.clientX + org_x - player.x\r\n    ) +\r\n    Math.PI / 2;\r\n  bullet_start_dir.x = Bullet.bulletSpeed * Math.sin(angle);\r\n  bullet_start_dir.y = -Bullet.bulletSpeed * Math.cos(angle);\r\n  // console.log(angle * 180 / Math.PI);\r\n});\r\nlet playerAccel = 2;\r\ndocument.addEventListener(\"keydown\", (event) => {\r\n  keyPressedPool.add(event.code);\r\n});\r\ndocument.addEventListener(\"keyup\", (event) => {\r\n  keyPressedPool.delete(event.code);\r\n  if (\r\n    controlKey.left.includes(event.code) ||\r\n    controlKey.right.includes(event.code)\r\n  )\r\n    player.ax = 0;\r\n  if (\r\n    controlKey.up.includes(event.code) ||\r\n    controlKey.down.includes(event.code)\r\n  )\r\n    player.ay = 0;\r\n});\r\ndocument.addEventListener(\"mousedown\", (event) => {\r\n  if (event.button === 0) keyPressedPool.add(\"LeftMouse\");\r\n});\r\ndocument.addEventListener(\"mouseup\", (event) => {\r\n  if (event.button === 0) keyPressedPool.delete(\"LeftMouse\");\r\n});\r\ndocument.addEventListener(\"visibilitychange\", () => {\r\n  keyPressedPool.clear();\r\n  player.ax = 0;\r\n  player.ay = 0;\r\n});\r\ndocument.oncontextmenu = () => false;\r\nwindow.addEventListener(\"resize\", () => {\r\n  if (window.innerHeight !== c_height) {\r\n    location.reload();\r\n  }\r\n});\r\n\r\n//#endregion\r\n\r\n//#region Set up\r\nfunction setup(){\r\n  score = 0; \r\n  rounded_score = 0;\r\n  enemy = [\r\n    (() => {\r\n      let _r = minR + ModifiedRandomBelowAvg() * (maxR - minR);\r\n      let e = Enemy(\r\n        c_width / 2,\r\n        c_height / 5,\r\n        minVertices,\r\n        maxVertices,\r\n        _r / 4,\r\n        _r,\r\n        {\r\n          _x: -1 + Math.random() * 2,\r\n          _y: -1 + Math.random() * 2,\r\n        }\r\n      );\r\n      let a = getMaxMinCo_Enemy(e);\r\n      e.top = a.yMin + e.data[0].oy;\r\n      e.bottom = a.yMax + e.data[0].oy;\r\n      e.right = a.xMax + e.data[0].ox;\r\n      e.left = a.xMin + e.data[0].ox;\r\n      return e;\r\n    })(),\r\n  ];\r\n  for (let i = 1; i < n_enemy; i++) {\r\n    enemy.push(newEnemy());\r\n  }\r\n  player = createPlayer();\r\n}\r\nsetup();\r\n//#endregion\r\n\r\n//#region Main Loop\r\n// _________________MAIN_LOOP_________________\r\nfunction draw() {\r\n  player.py = player.y;\r\n  player.px = player.x;\r\n\r\n  player.update();\r\n  c.clearRect(org_x, org_y, c_width, c_height);\r\n\r\n  //#region Draw Stuffs\r\n  for (let i = 0; i < enemy.length; i++) {\r\n    if (enemy[i].state) updateEnemy(enemy[i]);\r\n  }\r\n  for (let i = 0; i < enemy.length; i++) {\r\n    if (enemy[i].state) {\r\n      drawEnemy(enemy[i]);\r\n    }\r\n  }\r\n  drawPlayer(player);\r\n  rounded_score = ~~score;\r\n  c.fillText(`Score(x${scoremult}):${rounded_score}`, org_x + 10, org_y + 32);\r\n  //#endregion\r\n\r\n  //#region Enemy Wrap Around\r\n  for (let i = 0; i !== enemy.length; i++) {\r\n    let left = enemy[i].left;\r\n    let right = enemy[i].right;\r\n    let top = enemy[i].top;\r\n    let bottom = enemy[i].bottom;\r\n    if (left > org_x + c_width) {\r\n      let a = right - org_x;\r\n      enemy[i].left -= a;\r\n      enemy[i].right -= a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].x -= a;\r\n        enemy[i].data[j].ox -= a;\r\n      }\r\n    } else if (right < org_x) {\r\n      let a = c_width + org_x - left;\r\n      enemy[i].left += a;\r\n      enemy[i].right += a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].x += a;\r\n        enemy[i].data[j].ox += a;\r\n      }\r\n    }\r\n    if (bottom < -maxMapHeight) {\r\n      let a = c_height - top;\r\n      enemy[i].top += a;\r\n      enemy[i].bottom += a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].y += a;\r\n        enemy[i].data[j].oy += a;\r\n      }\r\n    } else if (top > c_height) {\r\n      let a = maxMapHeight + bottom;\r\n      enemy[i].top -= a;\r\n      enemy[i].bottom -= a;\r\n      for (let j = 0; j !== enemy[i].data.length; j++) {\r\n        enemy[i].data[j].y -= a;\r\n        enemy[i].data[j].oy -= a;\r\n      }\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Draw bullets & Collision detection between bullets & others\r\n  for (let i = 0; i < bullet.length; i++) {\r\n    if (bullet[i].state) {\r\n      drawBullet(bullet[i]);\r\n      bullet[i].px = bullet[i].x;\r\n      bullet[i].py = bullet[i].y;\r\n      bullet[i].update();\r\n\r\n      let b_x = bullet[i].x,\r\n        b_y = bullet[i].y;\r\n      //#region Player Collision Detection\r\n      if(isHardMode){\r\n        let squareDist = (player.x - b_x) ** 2 + (player.y - b_y) ** 2;\r\n        if (squareDist <= (player.size / 3 + bullet[i].r) ** 2) {\r\n          resetPlayer(player);\r\n        }\r\n      }\r\n      //#endregion\r\n\r\n      //#region Enemy Collsion Detection\r\n      for (let m = 0, __l = enemy.length; m !== __l; m++) {\r\n        if (!enemy[m].state) continue;\r\n        if (\r\n          b_x > enemy[m].left - 10 &&\r\n          b_x < enemy[m].right + 10 &&\r\n          b_y < enemy[m].bottom + 10 &&\r\n          b_y > enemy[m].top - 10\r\n        ) {\r\n          let inter_x,\r\n            inter_y,\r\n            inter_count = 0,\r\n            inter_index = 0,\r\n            n;\r\n\r\n          // let inter = checkCollision_Bullet_Enemy(bullet[i], enemy[m]);\r\n          // if (inter) {\r\n          //   inter_index = inter.index;\r\n          //   inter_count++;\r\n          //   n = inter.normal;\r\n          //   inter_x = inter.x;\r\n          //   inter_y = inter.y;\r\n          //   c.beginPath()\r\n          //   c.moveTo(inter_x, inter_y);\r\n          //   c.lineTo(inter.x + n.x * 100, inter_y + n.y * 100);\r\n          //   c.stroke();\r\n          // }\r\n          for (let j = 0, l = enemy[m].data.length; j !== l; j++) {\r\n            let x3 = enemy[m].data[j].x,\r\n              y3 = enemy[m].data[j].y,\r\n              x4 = enemy[m].data[(j + 1) % l].x,\r\n              y4 = enemy[m].data[(j + 1) % l].y;\r\n            //#region Check how many collision\r\n            let inter = checkCollision(\r\n              b_x,\r\n              b_y,\r\n              bullet[i].px + enemy[m].dir.x,\r\n              bullet[i].py + enemy[m].dir.y,\r\n              x3,\r\n              y3,\r\n              x4,\r\n              y4\r\n            );\r\n            if (inter) {\r\n              inter_index = j;\r\n              inter_count++;\r\n              n = normalizeVector(y3 - y4, x4 - x3);\r\n              inter_x = inter.x;\r\n              inter_y = inter.y;\r\n              // c.beginPath()\r\n              // c.moveTo(inter_x, inter_y);\r\n              // c.lineTo(inter.x + y3 - y4, inter_y + x4 - x3);\r\n              // c.stroke();\r\n            }\r\n            //#endregion\r\n          }\r\n          if (inter_count % 2 !== 0) {\r\n            //#region IF HIT\r\n            //#region OLD collision\r\n            let xd = bullet[i].dir.x,\r\n              yd = bullet[i].dir.y;\r\n            let t = n.x * xd + n.y * yd;\r\n            if (t >= 0) {\r\n              bullet[i].dir.x -= 2 * n.x * t - enemy[m].dir.x;\r\n              bullet[i].dir.y -= 2 * n.y * t - enemy[m].dir.y;\r\n            } else {\r\n              bullet[i].dir.x += enemy[m].dir.x;\r\n              bullet[i].dir.y += enemy[m].dir.y;\r\n            }\r\n\r\n            enemy[m].dir.x +=\r\n              (enemy[m].dir.x < player.max_v - 2) *\r\n              (xd - bullet[i].dir.x) *\r\n              (50 / enemy[m].maxR ** 2);\r\n            enemy[m].dir.y +=\r\n              (enemy[m].dir.y < player.max_v - 2) *\r\n              (yd - bullet[i].dir.y) *\r\n              (50 / enemy[m].maxR ** 2);\r\n            //#endregion\r\n            //#region Oof\r\n            // let xd = bullet[i].dir.x,\r\n            //   yd = bullet[i].dir.y,\r\n            //   xe = enemy[m].dir.x,\r\n            //   ye = enemy[m].dir.y;\r\n            // let v1 = Math.sqrt(xd ** 2 + yd ** 2),\r\n            //   m1 = 1,\r\n            //   phi1 = Math.atan2(yd, xd);\r\n            // let v2 = Math.sqrt(xe ** 2 + ye ** 2),\r\n            //   m2 = enemy[m].maxR,\r\n            //   phi2 = Math.atan2(ye, xe);\r\n            // let __n = normalizeVector(bullet[i].dir.x, bullet[i].dir.y);\r\n            // let small_phi = Math.atan2(\r\n            //   inter_y - inter_y*__n.x,\r\n            //   inter_x - inter_x*__n.y\r\n            // );\r\n            // let a =\r\n            //     (v1 * (m1 - m2) * Math.cos(phi1 - small_phi) +\r\n            //       2 * m2 * v2 * Math.cos(phi2 - small_phi)) /\r\n            //     (m1 + m2),\r\n            //   a1 =\r\n            //     v1 *\r\n            //     Math.sin(phi1 - small_phi) ;\r\n\r\n            // bullet[i].dir.x =\r\n            //   a * Math.cos(small_phi) + a1 * Math.cos(small_phi + Math.PI / 2);\r\n            // bullet[i].dir.y =\r\n            //   a * Math.sin(small_phi) + a1 * Math.sin(small_phi + Math.PI / 2);\r\n\r\n            // let b =\r\n            //     (v2 * (m2 - m1) * Math.cos(phi2 - small_phi) +\r\n            //       2 * m1 * v1 * Math.cos(phi1 - small_phi)) /\r\n            //     (m1 + m2),\r\n            //   b1 =\r\n            //     v2 *\r\n            //     Math.sin(phi2 - small_phi);\r\n\r\n            // enemy[m].dir.x =\r\n            //   b * Math.cos(small_phi) + b1 * Math.cos(small_phi + Math.PI / 2);\r\n            // enemy[m].dir.y =\r\n            //   b * Math.sin(small_phi) + b1 * Math.sin(small_phi + Math.PI / 2);\r\n            //#endregion\r\n            let _n = normalizeVector(bullet[i].dir.x, bullet[i].dir.y);\r\n            1;\r\n            bullet[i].x = inter_x + _n.x;\r\n            bullet[i].y = inter_y + _n.y;\r\n            // bullet[i].x += enemy[m].dir.x * _n.x;\r\n            // bullet[i].y += enemy[m].dir.y * _n.y;\r\n\r\n            // bullet[i].dir.x *= 0.9;\r\n            // bullet[i].dir.y *= 0.9;\r\n\r\n            enemy[m].health -= bullet[i].damage;\r\n            score += bullet[i].damage * scoremult;\r\n            bullet[i].damage *= Math.sqrt(\r\n              (bullet[i].dir.x ** 2 + bullet[i].dir.y ** 2) / (xd**2 + yd**2)\r\n            );\r\n \r\n            //#region Enemy die and split\r\n            if (enemy[m].health < 1) {\r\n              enemy[m].state = 0;\r\n              score += enemy[m].o_health * scoremult;\r\n              let spawned = 0;\r\n              let t =\r\n                (inter_index + 1 + ~~(enemy[m].data.length / 2)) %\r\n                enemy[m].data.length;\r\n              let a = inter_index + 1,\r\n                b = t, \r\n                e1;\r\n              let arr = enemy[m].data;\r\n              let oldCenterX = arr[0].ox, oldCenterY = arr[0].oy;\r\n              let copy_of_b = { ...arr[b] };\r\n              if (a < b) {\r\n                e1 = arr.splice(\r\n                  a,\r\n                  b - a + 1,\r\n                  {\r\n                    ox: arr[0].ox,\r\n                    oy: arr[0].oy,\r\n                    x: arr[0].ox,\r\n                    y: arr[0].oy,\r\n                  },\r\n                  copy_of_b\r\n                );\r\n              } else {\r\n                e1 = arr.splice(\r\n                  b,\r\n                  a - b ,\r\n                  copy_of_b,\r\n                  {\r\n                    ox: arr[0].ox,\r\n                    oy: arr[0].oy,\r\n                    x: arr[0].ox,\r\n                    y: arr[0].oy,\r\n                  }\r\n                );\r\n              }\r\n              e1.push({\r\n                ox: arr[0].ox,\r\n                oy: arr[0].oy,\r\n                x: arr[0].ox,\r\n                y: arr[0].oy,\r\n              });\r\n              // console.log(e1.slice());\r\n              if (e1.length > 3 && !checkIfPolygonSelfIntersect(e1)) {\r\n                let newCenter = getCentroidOfPolygon(e1);\r\n                for (let v = 0; v < e1.length; v++) {\r\n                  e1[v].ox = newCenter.x;\r\n                  e1[v].oy = newCenter.y;\r\n                }\r\n                let q = 1;\r\n                for (let z = 0; z < enemy.length; z++) {\r\n                  if (!enemy[z].state) {\r\n                    enemy[z] = new EnemyFromData(e1, {\r\n                      x: enemy[m].dir.x + 2 * (e1[0].ox - oldCenterX) / enemy[m].maxR,\r\n                      y: enemy[m].dir.y + 2 * (e1[0].oy - oldCenterY) / enemy[m].maxR,\r\n                    });\r\n                    if (getAreaOfPolygon(enemy[z].data) < 1800) {\r\n                      enemy[z].state = 0;\r\n                      spawned--;\r\n                    }\r\n                    q = 0;\r\n                    break;\r\n                  }\r\n                }\r\n                if (q) {\r\n                  enemy.push(\r\n                    new EnemyFromData(e1, {\r\n                      x: enemy[m].dir.x + 2 * (e1[0].ox - oldCenterX) / enemy[m].maxR,\r\n                      y: enemy[m].dir.y + 2 * (e1[0].oy - oldCenterY) / enemy[m].maxR,\r\n                    })\r\n                  );\r\n                  if (getAreaOfPolygon(enemy[enemy.length - 1].data) < 1800) {\r\n                    enemy[enemy.length - 1].state = 0;\r\n                    spawned--;\r\n                  }\r\n                }\r\n                spawned++;\r\n              }\r\n              let e2 = arr;\r\n              if (e2.length > 3 && !checkIfPolygonSelfIntersect(e2)) {\r\n                let newCenter = getCentroidOfPolygon(e2);\r\n                for (let v = 0; v < e2.length; v++) {\r\n                  e2[v].ox = newCenter.x;\r\n                  e2[v].oy = newCenter.y;\r\n                }\r\n                let q = 1;\r\n                for (let z = 0; z < enemy.length; z++) {\r\n                  if (!enemy[z].state) {\r\n                    enemy[z] = new EnemyFromData(e2, {\r\n                      x: enemy[m].dir.x + 2 * (e2[0].ox - oldCenterX) / enemy[m].maxR,\r\n                      y: enemy[m].dir.y + 2 * (e2[0].oy - oldCenterY) / enemy[m].maxR,\r\n                    });\r\n                    if (getAreaOfPolygon(enemy[z].data) < 1800) {\r\n                      enemy[z].state = 0;\r\n                      spawned--;\r\n                    }\r\n                    q = 0;\r\n                    break;\r\n                  }\r\n                }\r\n                if (q) {\r\n                  enemy.push(\r\n                    new EnemyFromData(e2, {\r\n                      x: enemy[m].dir.x + 2 * (e2[0].ox - oldCenterX) / enemy[m].maxR,\r\n                      y: enemy[m].dir.y + 2 * (e2[0].oy - oldCenterY) / enemy[m].maxR,\r\n                    })\r\n                  );\r\n                  if (getAreaOfPolygon(enemy[enemy.length - 1].data) < 1800) {\r\n                    enemy[enemy.length - 1].state = 0;\r\n                    spawned--;\r\n                  }\r\n                }\r\n                spawned++;\r\n              }\r\n\r\n              if (isEndless && !spawned) {\r\n                let q = 1;\r\n                for (let z = 0; z < enemy.length; z++) {\r\n                  if (!enemy[z].state) {\r\n                    enemy[z] = newEnemy();\r\n                    q = 0;\r\n                    break;\r\n                  }\r\n                }\r\n                if (q) enemy.push(newEnemy());\r\n              }\r\n              break;\r\n            }\r\n            //#endregion\r\n          } else if (inter_count !== 0) {\r\n            bullet[i].state = 0;\r\n            enemy[m].health-= bullet[i].damage;\r\n            score += bullet[i].damage * scoremult;\r\n          }\r\n          //#endregion\r\n        }\r\n      }\r\n      //#endregion\r\n\r\n      if (\r\n        b_y < org_y - bullet[i].r ||\r\n        b_y > org_y + c_height ||\r\n        b_x < org_x ||\r\n        b_x > org_x + c_width ||\r\n        Math.sqrt(bullet[i].dir.x ** 2 + bullet[i].dir.y ** 2) < 0.65\r\n      ) {\r\n        bullet[i].state = 0;\r\n        continue;\r\n      }\r\n      // drawBullet(bullet[i]);\r\n    }\r\n  }\r\n  //#endregion\r\n  \r\n  //#region Player collision with enemies\r\n  for (let m = 0, __l = enemy.length; m !== __l; m++) {\r\n    if (!enemy[m].state) continue;\r\n    let player_x = player.x, player_y = player.y;\r\n    if (\r\n      player_x > enemy[m].left - 10 &&\r\n      player_x < enemy[m].right + 10 &&\r\n      player_y < enemy[m].bottom + 10 &&\r\n      player_y > enemy[m].top - 10\r\n    ) {\r\n      for (let j = 0, l = enemy[m].data.length; j !== l; j++) {\r\n        let x3 = enemy[m].data[j].x,\r\n          y3 = enemy[m].data[j].y,\r\n          x4 = enemy[m].data[(j + 1) % l].x,\r\n          y4 = enemy[m].data[(j + 1) % l].y;\r\n        if (checkCollision(\r\n          player_x,\r\n          player_y,\r\n          player.px + enemy[m].dir.x,\r\n          player.py + enemy[m].dir.y,\r\n          x3,\r\n          y3,\r\n          x4,\r\n          y4\r\n        )) {\r\n          resetPlayer(player);\r\n        }\r\n      }\r\n    }\r\n  }\r\n  //#endregion\r\n\r\n  //#region Camera moves with player\r\n  if (player.py !== player.y || player.px !== player.x) {\r\n    translate_x = (player.px - player.x) * 0.1;\r\n    translate_y = player.py - player.y;\r\n    org_x -= translate_x;\r\n    if (player.y >= org_player_y) translate_y = org_y;\r\n    else if (player.y <= -maxMapHeight + org_player_y)\r\n      translate_y = org_y + maxMapHeight;\r\n\r\n    org_y -= translate_y;\r\n    c.translate(translate_x, translate_y);\r\n  }\r\n  //#endregion\r\n\r\n  //#region Input check\r\n  if (keyPressedPool.size) {\r\n    if (controlKey.focus.filter((x) => keyPressedPool.has(x)).length) {\r\n      player.max_v = 4;\r\n      o_bulletTimer = 2;\r\n    } else {\r\n      player.max_v = 8;\r\n      o_bulletTimer = 4;\r\n    }\r\n\r\n    if (controlKey.up.filter((x) => keyPressedPool.has(x)).length)\r\n      player.ay = -playerAccel;\r\n    if (controlKey.down.filter((x) => keyPressedPool.has(x)).length)\r\n      player.ay = playerAccel;\r\n    if (controlKey.left.filter((x) => keyPressedPool.has(x)).length)\r\n      player.ax = -playerAccel;\r\n    if (controlKey.right.filter((x) => keyPressedPool.has(x)).length)\r\n      player.ax = playerAccel;\r\n    if (controlKey.shoot.filter((x) => keyPressedPool.has(x)).length) {\r\n      if (!bulletTimer) {\r\n        let n = 1;\r\n        for (let i = 0; i < bullet.length; i++) {\r\n          if (!bullet[i].state) {\r\n            bullet[i].reset(\r\n              player.x + (player.size / 2) * Math.cos(angle - Math.PI / 2),\r\n              player.y + (player.size / 2) * Math.sin(angle - Math.PI / 2),\r\n              { ...bullet_start_dir }\r\n            );\r\n            n = 0;\r\n            break;\r\n          }\r\n        }\r\n        if (n)\r\n          bullet.push(\r\n            new Bullet(\r\n              player.x + (player.size / 2) * Math.cos(angle - Math.PI / 2),\r\n              player.y + (player.size / 2) * Math.sin(angle - Math.PI / 2),\r\n              5,\r\n              { ...bullet_start_dir }\r\n            )\r\n          );\r\n        bulletTimer = o_bulletTimer;\r\n      } else bulletTimer--;\r\n    }\r\n  }\r\n  //#endregion\r\n  requestAnimationFrame(draw);\r\n}\r\ndraw();\r\n//#endregion\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}